<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>sparktk.lazyloader API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: Arial, Helvetica, sans;
    font-size: 14px;
  }
  #content {
    position: absolute;
    left: 25%;
    right: 0;
    top: 0;
    bottom: 0;
    overflow: auto;
    padding: 30px;
    height: 100%;
  }
  #sidebar {
    position: absolute;
    width: 25%;
    top: 0;
    right: 0;
    left: 0;
    padding: 30px;
    overflow: auto;
    height: 100%;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #fixed_top_left {
    display: block;
    position: fixed;
    top: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
    background: transparent;
    z-index: 1;  /* Set z-index so that it doesn't get lost behind the sidebar */
  }

  #footer {
    font-size: .75em;
    margin-top: 20px;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    font-size: 1.5em;
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name, .param-name {
    font-family: Consolas, "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }
  .section-header {
    font-weight: bold;
    padding: 10px 0 5px 0;
  }
  .param-name {
    font-weight: bold;
    text-align: left;
    vertical-align: top;
  }
  .param-type {
    font-style: italic;
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  .param-desc {
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
      background: #f9f9f9;
      font-size: 13px;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 20px 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
  <a href="index.html" id="fixed_top_left">Up</a>
  <!--<a href="#" id="top">Top</a>-->
  <div id="container">
      
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#sparktk.lazyloader.logger">logger</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#sparktk.lazyloader.add_loader_property">add_loader_property</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.add_module_element_properties">add_module_element_properties</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.create_class_type">create_class_type</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.create_lazy_loader">create_lazy_loader</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.create_loader_property">create_loader_property</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.get_lazy_loader">get_lazy_loader</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.get_module_name">get_module_name</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.init_lazy_loader_class">init_lazy_loader_class</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.is_public_python_name">is_public_python_name</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.name_to_private">name_to_private</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.validate_is_implicit">validate_is_implicit</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.validate_public_python_name">validate_public_python_name</a></li>
    <li class="mono"><a href="#sparktk.lazyloader.wrap_for_implicit_kwargs">wrap_for_implicit_kwargs</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#sparktk.lazyloader.LazyLoader">LazyLoader</a></span>
        
        </li>
      </ul>
    </li>

    </ul>
  </div>

      <article id="content">
        <div>
        
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">sparktk.lazyloader</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader" class="source">
    <div class="codehilite"><pre><span class="c"># vim: set encoding=utf-8</span>

<span class="c">#  Copyright (c) 2016 Intel Corporation </span>
<span class="c">#</span>
<span class="c">#  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c">#  you may not use this file except in compliance with the License.</span>
<span class="c">#  You may obtain a copy of the License at</span>
<span class="c">#</span>
<span class="c">#       http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c">#</span>
<span class="c">#  Unless required by applicable law or agreed to in writing, software</span>
<span class="c">#  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c">#  See the License for the specific language governing permissions and</span>
<span class="c">#  limitations under the License.</span>
<span class="c">#</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">decorator</span> <span class="kn">import</span> <span class="n">decorator</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sparktk.arguments</span> <span class="kn">import</span> <span class="n">implicit</span>


<span class="k">class</span> <span class="nc">LazyLoader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Building-block object used to build out on-demand access to library subpackages, modules, and module contents.</span>

<span class="sd">    For a given file path, we build a custom class type (inheriting LazyLoader) which has properties to access each</span>
<span class="sd">    child subpackage or module found in the path.  These properties in turn, when accessed during runtime, create</span>
<span class="sd">    more lazy loader blocks for their descendents.  Only when module content is directly accessed does the module</span>
<span class="sd">    hierarchy actually get imported.</span>

<span class="sd">    Enables interactive script code, tabbing out the dots, like this:</span>

<span class="sd">    ``tc.models.clustering.kmeans.train(...)``</span>

<span class="sd">    Where nothing is actually loaded until the content of the kmeans module is needed.</span>

<span class="sd">    Also supports implicitly filling in function kwargs.  The lazy loader at creation time can be given a dict</span>
<span class="sd">    of kwargs which it will use to fill in function calls when referenced off the lazy loader.  For example, we can</span>
<span class="sd">    define the function:</span>


<span class="sd">        def great_read(uri, config, tc=implicit):</span>
<span class="sd">           return tc.thing.read(uri, config)</span>

<span class="sd">    If we lazily load great_read under tc somewhere, we&#39;d like the tc to be passed implicitly, rather than</span>
<span class="sd">    awkwardly specifying it again:</span>

<span class="sd">        config = {&#39;x&#39;: 1, &#39;y&#39;: 2}</span>
<span class="sd">        tc.readers.great_read(&#39;my_uri&#39;, config)  # no need to pass &#39;tc&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">get_lazy_loader</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">package_name</span><span class="o">=</span><span class="s">&#39;sparktk&#39;</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the lazy loader for the given instance and relative descendent name</span>

<span class="sd">    :param instance: object which will own this lazy loader (the parent)</span>
<span class="sd">    :param name: the name the lazy loader will assume under this instance, which is the name of the module to be loaded</span>
<span class="sd">    :param parent_path: os path to the parent folder of the module called name; if not specified, it will be the path to THIS module&#39;s parent</span>
<span class="sd">    :param package_name: name of the root package within the parent_path</span>
<span class="sd">    :param implicit_kwargs:  dict of kwargs to use to implicitly fill arguments in functions loaded by this loader (and its descendents)</span>
<span class="sd">    :return: a lazy loader object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_public_python_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">private_name</span> <span class="o">=</span> <span class="n">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;get_lazy_loader(name=</span><span class="si">%s</span><span class="s">) --&gt; private name=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">private_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parent_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">parent_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>  <span class="c"># default to local sparktk path, relative to here</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_path</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">lazy_loader</span> <span class="o">=</span> <span class="n">create_lazy_loader</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">private_name</span><span class="p">,</span> <span class="n">lazy_loader</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_lazy_loader</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a lazy loader access object for the given path, usually an absolute path&quot;&quot;&quot;</span>
    <span class="n">class_name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">piece</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
                          <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)])</span> <span class="o">+</span> <span class="n">LazyLoader</span><span class="o">.</span><span class="n">__name__</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;create_lazy_loader(path=</span><span class="si">%s</span><span class="s">, package_name=</span><span class="si">%s</span><span class="s">, implicit_kwargs=</span><span class="si">%s</span><span class="s">) --&gt; class_name=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
    <span class="n">lazy_loader_class</span> <span class="o">=</span> <span class="n">create_class_type</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="o">=</span><span class="n">LazyLoader</span><span class="p">)</span>
    <span class="n">init_lazy_loader_class</span><span class="p">(</span><span class="n">lazy_loader_class</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">lazy_loader_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">instance</span>


<span class="k">def</span> <span class="nf">init_lazy_loader_class</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes class (not instance!) by adding properties to access descendent subpackages, modules, and content&quot;&quot;&quot;</span>

    <span class="c"># If path is a directory, then this lazy loader class needs properties for the descendents</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">children</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child_name</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">child_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">child_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">child_path</span><span class="p">):</span>
                <span class="n">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">child_path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">child_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">child_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">child_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">child_path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;LazyLoader skipping </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">child_path</span><span class="p">)</span>

    <span class="c"># If path is a .py file, then this lazy loader class needs properties for the elements of the module</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">):</span>
        <span class="n">add_module_element_properties</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Bad path for LazyLoader init.  Expected valid package dir or .py file, but got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">path</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_class_type</span><span class="p">(</span><span class="n">new_class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamically create a class type with the given name and namespace_obj&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Creating new class type &#39;</span><span class="si">%s</span><span class="s">&#39; with baseclass=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">new_class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="p">)</span>
    <span class="n">new_class</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_class_name</span><span class="p">),</span>
                     <span class="p">(</span><span class="n">baseclass</span><span class="p">,),</span>
                     <span class="p">{</span><span class="s">&#39;__module__&#39;</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]})</span>
    <span class="c"># assign to its module, and to globals</span>
    <span class="c"># http://stackoverflow.com/questions/13624603/python-how-to-register-dynamic-class-in-module</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">new_class</span><span class="o">.</span><span class="n">__module__</span><span class="o">.</span><span class="n">__name__</span><span class="p">],</span> <span class="n">new_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">new_class</span><span class="p">)</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="n">new_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_class</span>
    <span class="k">return</span> <span class="n">new_class</span>


<span class="k">def</span> <span class="nf">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the correct python module name for the given os path, relative to a particular package&quot;&quot;&quot;</span>
    <span class="n">package_index</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">package_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">package_index</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;package_name </span><span class="si">%s</span><span class="s"> not found in path </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;makes private version of the name&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span>


<span class="k">def</span> <span class="nf">is_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected string value, got None&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;^[A-Za-z][\w_]*$&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">validate_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Value </span><span class="si">%s</span><span class="s"> is not a valid python variable name&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_loader_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a property whose getter will create, if it does not yet exist, a lazy loader object for the path&quot;&quot;&quot;</span>
    <span class="n">loader_path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="n">private_name</span> <span class="o">=</span> <span class="n">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">loader_package_name</span> <span class="o">=</span> <span class="n">package_name</span>

    <span class="k">def</span> <span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">private_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>   <span class="c"># don&#39;t use hasattr, because it would match an inherited prop</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">create_lazy_loader</span><span class="p">(</span><span class="n">loader_path</span><span class="p">,</span> <span class="n">loader_package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">private_name</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>

    <span class="n">prop</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">fget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prop</span>


<span class="k">def</span> <span class="nf">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a property to the cls which accesses a lazy loader for a descendent&quot;&quot;&quot;</span>
    <span class="n">prop</span> <span class="o">=</span> <span class="n">create_loader_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Adding lazy loader property named </span><span class="si">%s</span><span class="s"> to class </span><span class="si">%s</span><span class="s"> for path </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">add_module_element_properties</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically imports the module and adds properties for each element found in the module to the given class</span>

<span class="sd">    __all__ is used if it is defined for the module, otherwise all non-private elements are aliased</span>

<span class="sd">    Module-level methods are aliased as static methods in the lazy loader class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">module_name</span> <span class="o">=</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Dynamically loading module </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">module_name</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;__all__&#39;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">__all__</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">implicit_kwargs</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">wrap_for_implicit_kwargs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Adding property </span><span class="si">%s</span><span class="s"> for element </span><span class="si">%s</span><span class="s"> to class </span><span class="si">%s</span><span class="s"> for path </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">wrap_for_implicit_kwargs</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;possibly wraps the function in a decorator which will implicitly fill in kwargs when called&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;wrap_for_implicit_kwargs(function=</span><span class="si">%s</span><span class="s">, implicit_kwargs=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">args</span><span class="p">,</span> <span class="n">varargs</span><span class="p">,</span> <span class="n">varkwargs</span><span class="p">,</span> <span class="n">defaults</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;argspec = (args=</span><span class="si">%s</span><span class="s">,varargs=</span><span class="si">%s</span><span class="s">,varkwargs=</span><span class="si">%s</span><span class="s">,defaults=</span><span class="si">%s</span><span class="s">)&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">varargs</span><span class="p">,</span> <span class="n">varkwargs</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
    <span class="n">kwarg_index_value_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                               <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">implicit_kwargs</span> <span class="ow">and</span> <span class="n">validate_is_implicit</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">kwarg_index_value_pairs</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">call_with_implicit_kwargs</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;call_with_implicit_kwargs wrapper used for a decorator&quot;&quot;&quot;</span>
            <span class="n">args_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwarg_index_value_pairs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">args_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">is</span> <span class="n">implicit</span><span class="p">:</span>
                    <span class="n">args_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args_list</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;wrap_for_implicit_kwargs decorating </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">kwarg_index_value_pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">call_with_implicit_kwargs</span><span class="p">,</span> <span class="n">function</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">function</span>


<span class="k">def</span> <span class="nf">validate_is_implicit</span><span class="p">(</span><span class="n">function_name</span><span class="p">,</span> <span class="n">arg_index</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">defaults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Raises a TypeError if the kwarg does not have an implicit default value&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">default_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span> <span class="k">if</span> <span class="n">defaults</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">default_index</span> <span class="o">=</span> <span class="n">arg_index</span> <span class="o">-</span> <span class="n">default_offset</span>
        <span class="k">if</span> <span class="n">default_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">assert</span><span class="p">(</span><span class="n">defaults</span><span class="p">[</span><span class="n">default_index</span><span class="p">]</span> <span class="ow">is</span> <span class="n">implicit</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Lazyloader asked to implicitly fill arg &#39;</span><span class="si">%s</span><span class="s">&#39; but it is not marked implicit in function </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">],</span> <span class="n">function_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">True</span>  <span class="c"># return true for list comp construction</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="sparktk.lazyloader.logger" class="name">var <span class="ident">logger</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.add_loader_property">
    <p>def <span class="ident">add_loader_property</span>(</p><p>cls, name, path, package_name, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Adds a property to the cls which accesses a lazy loader for a descendent</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.add_loader_property', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.add_loader_property" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a property to the cls which accesses a lazy loader for a descendent&quot;&quot;&quot;</span>
    <span class="n">prop</span> <span class="o">=</span> <span class="n">create_loader_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Adding lazy loader property named </span><span class="si">%s</span><span class="s"> to class </span><span class="si">%s</span><span class="s"> for path </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.add_module_element_properties">
    <p>def <span class="ident">add_module_element_properties</span>(</p><p>cls, path, package_name, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Dynamically imports the module and adds properties for each element found in the module to the given class</p>
<p><strong>all</strong> is used if it is defined for the module, otherwise all non-private elements are aliased</p>
<p>Module-level methods are aliased as static methods in the lazy loader class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.add_module_element_properties', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.add_module_element_properties" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">add_module_element_properties</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically imports the module and adds properties for each element found in the module to the given class</span>

<span class="sd">    __all__ is used if it is defined for the module, otherwise all non-private elements are aliased</span>

<span class="sd">    Module-level methods are aliased as static methods in the lazy loader class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">module_name</span> <span class="o">=</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Dynamically loading module </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">module_name</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s">&#39;__all__&#39;</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">__all__</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)])</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s">&#39;__call__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">implicit_kwargs</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">wrap_for_implicit_kwargs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Adding property </span><span class="si">%s</span><span class="s"> for element </span><span class="si">%s</span><span class="s"> to class </span><span class="si">%s</span><span class="s"> for path </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.create_class_type">
    <p>def <span class="ident">create_class_type</span>(</p><p>new_class_name, baseclass)</p>
    </div>
    

    
  
    <div class="desc"><p>Dynamically create a class type with the given name and namespace_obj</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.create_class_type', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.create_class_type" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create_class_type</span><span class="p">(</span><span class="n">new_class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dynamically create a class type with the given name and namespace_obj&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Creating new class type &#39;</span><span class="si">%s</span><span class="s">&#39; with baseclass=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">new_class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="p">)</span>
    <span class="n">new_class</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_class_name</span><span class="p">),</span>
                     <span class="p">(</span><span class="n">baseclass</span><span class="p">,),</span>
                     <span class="p">{</span><span class="s">&#39;__module__&#39;</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]})</span>
    <span class="c"># assign to its module, and to globals</span>
    <span class="c"># http://stackoverflow.com/questions/13624603/python-how-to-register-dynamic-class-in-module</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">new_class</span><span class="o">.</span><span class="n">__module__</span><span class="o">.</span><span class="n">__name__</span><span class="p">],</span> <span class="n">new_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">new_class</span><span class="p">)</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="n">new_class</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_class</span>
    <span class="k">return</span> <span class="n">new_class</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.create_lazy_loader">
    <p>def <span class="ident">create_lazy_loader</span>(</p><p>path, package_name, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a lazy loader access object for the given path, usually an absolute path</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.create_lazy_loader', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.create_lazy_loader" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create_lazy_loader</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a lazy loader access object for the given path, usually an absolute path&quot;&quot;&quot;</span>
    <span class="n">class_name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">piece</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
                          <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)])</span> <span class="o">+</span> <span class="n">LazyLoader</span><span class="o">.</span><span class="n">__name__</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;create_lazy_loader(path=</span><span class="si">%s</span><span class="s">, package_name=</span><span class="si">%s</span><span class="s">, implicit_kwargs=</span><span class="si">%s</span><span class="s">) --&gt; class_name=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
    <span class="n">lazy_loader_class</span> <span class="o">=</span> <span class="n">create_class_type</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">baseclass</span><span class="o">=</span><span class="n">LazyLoader</span><span class="p">)</span>
    <span class="n">init_lazy_loader_class</span><span class="p">(</span><span class="n">lazy_loader_class</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">lazy_loader_class</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">instance</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.create_loader_property">
    <p>def <span class="ident">create_loader_property</span>(</p><p>name, path, package_name, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a property whose getter will create, if it does not yet exist, a lazy loader object for the path</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.create_loader_property', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.create_loader_property" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create_loader_property</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a property whose getter will create, if it does not yet exist, a lazy loader object for the path&quot;&quot;&quot;</span>
    <span class="n">loader_path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="n">private_name</span> <span class="o">=</span> <span class="n">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">loader_package_name</span> <span class="o">=</span> <span class="n">package_name</span>

    <span class="k">def</span> <span class="nf">fget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">private_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>   <span class="c"># don&#39;t use hasattr, because it would match an inherited prop</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="n">create_lazy_loader</span><span class="p">(</span><span class="n">loader_path</span><span class="p">,</span> <span class="n">loader_package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">private_name</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>

    <span class="n">prop</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">fget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prop</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.get_lazy_loader">
    <p>def <span class="ident">get_lazy_loader</span>(</p><p>instance, name, parent_path=None, package_name=&#39;sparktk&#39;, implicit_kwargs=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Gets the lazy loader for the given instance and relative descendent name</p>
<table><tr><td class='param-name'>instance: </td><td class='param-desc'>object which will own this lazy loader (the parent)
</td></tr></table>

<table><tr><td class='param-name'>name: </td><td class='param-desc'>the name the lazy loader will assume under this instance, which is the name of the module to be loaded
</td></tr></table>

<table><tr><td class='param-name'>parent_path: </td><td class='param-desc'>os path to the parent folder of the module called name; if not specified, it will be the path to THIS module's parent
</td></tr></table>

<table><tr><td class='param-name'>package_name: </td><td class='param-desc'>name of the root package within the parent_path
</td></tr></table>

<table><tr><td class='param-name'>implicit_kwargs: </td><td class='param-desc'> dict of kwargs to use to implicitly fill arguments in functions loaded by this loader (and its descendents)
</td></tr></table>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns: </td><td class='param-desc'>a lazy loader object</td></tr></table></p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.get_lazy_loader', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.get_lazy_loader" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_lazy_loader</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">package_name</span><span class="o">=</span><span class="s">&#39;sparktk&#39;</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the lazy loader for the given instance and relative descendent name</span>

<span class="sd">    :param instance: object which will own this lazy loader (the parent)</span>
<span class="sd">    :param name: the name the lazy loader will assume under this instance, which is the name of the module to be loaded</span>
<span class="sd">    :param parent_path: os path to the parent folder of the module called name; if not specified, it will be the path to THIS module&#39;s parent</span>
<span class="sd">    :param package_name: name of the root package within the parent_path</span>
<span class="sd">    :param implicit_kwargs:  dict of kwargs to use to implicitly fill arguments in functions loaded by this loader (and its descendents)</span>
<span class="sd">    :return: a lazy loader object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_public_python_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">private_name</span> <span class="o">=</span> <span class="n">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;get_lazy_loader(name=</span><span class="si">%s</span><span class="s">) --&gt; private name=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">private_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parent_path</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">parent_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>  <span class="c"># default to local sparktk path, relative to here</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_path</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">lazy_loader</span> <span class="o">=</span> <span class="n">create_lazy_loader</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">private_name</span><span class="p">,</span> <span class="n">lazy_loader</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">private_name</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.get_module_name">
    <p>def <span class="ident">get_module_name</span>(</p><p>path, package_name)</p>
    </div>
    

    
  
    <div class="desc"><p>Determines the correct python module name for the given os path, relative to a particular package</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.get_module_name', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.get_module_name" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">get_module_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the correct python module name for the given os path, relative to a particular package&quot;&quot;&quot;</span>
    <span class="n">package_index</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">package_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="n">package_index</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;package_name </span><span class="si">%s</span><span class="s"> not found in path </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.init_lazy_loader_class">
    <p>def <span class="ident">init_lazy_loader_class</span>(</p><p>cls, path, package_name, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes class (not instance!) by adding properties to access descendent subpackages, modules, and content</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.init_lazy_loader_class', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.init_lazy_loader_class" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">init_lazy_loader_class</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes class (not instance!) by adding properties to access descendent subpackages, modules, and content&quot;&quot;&quot;</span>

    <span class="c"># If path is a directory, then this lazy loader class needs properties for the descendents</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">children</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child_name</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">child_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">child_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">child_path</span><span class="p">):</span>
                <span class="n">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">child_path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">child_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">child_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">add_loader_property</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">child_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">child_path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;LazyLoader skipping </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">child_path</span><span class="p">)</span>

    <span class="c"># If path is a .py file, then this lazy loader class needs properties for the elements of the module</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.py&#39;</span><span class="p">):</span>
        <span class="n">add_module_element_properties</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Bad path for LazyLoader init.  Expected valid package dir or .py file, but got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">path</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.is_public_python_name">
    <p>def <span class="ident">is_public_python_name</span>(</p><p>s)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.is_public_python_name', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.is_public_python_name" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">is_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected string value, got None&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;^[A-Za-z][\w_]*$&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.name_to_private">
    <p>def <span class="ident">name_to_private</span>(</p><p>name)</p>
    </div>
    

    
  
    <div class="desc"><p>makes private version of the name</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.name_to_private', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.name_to_private" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">name_to_private</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;makes private version of the name&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.validate_is_implicit">
    <p>def <span class="ident">validate_is_implicit</span>(</p><p>function_name, arg_index, args, defaults)</p>
    </div>
    

    
  
    <div class="desc"><p>Raises a TypeError if the kwarg does not have an implicit default value</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.validate_is_implicit', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.validate_is_implicit" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">validate_is_implicit</span><span class="p">(</span><span class="n">function_name</span><span class="p">,</span> <span class="n">arg_index</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">defaults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Raises a TypeError if the kwarg does not have an implicit default value&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">default_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span> <span class="k">if</span> <span class="n">defaults</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">default_index</span> <span class="o">=</span> <span class="n">arg_index</span> <span class="o">-</span> <span class="n">default_offset</span>
        <span class="k">if</span> <span class="n">default_index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">assert</span><span class="p">(</span><span class="n">defaults</span><span class="p">[</span><span class="n">default_index</span><span class="p">]</span> <span class="ow">is</span> <span class="n">implicit</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Lazyloader asked to implicitly fill arg &#39;</span><span class="si">%s</span><span class="s">&#39; but it is not marked implicit in function </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">],</span> <span class="n">function_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">True</span>  <span class="c"># return true for list comp construction</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.validate_public_python_name">
    <p>def <span class="ident">validate_public_python_name</span>(</p><p>s)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.validate_public_python_name', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.validate_public_python_name" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">validate_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_public_python_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Value </span><span class="si">%s</span><span class="s"> is not a valid python variable name&quot;</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.lazyloader.wrap_for_implicit_kwargs">
    <p>def <span class="ident">wrap_for_implicit_kwargs</span>(</p><p>function, implicit_kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>possibly wraps the function in a decorator which will implicitly fill in kwargs when called</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.wrap_for_implicit_kwargs', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.wrap_for_implicit_kwargs" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">wrap_for_implicit_kwargs</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;possibly wraps the function in a decorator which will implicitly fill in kwargs when called&quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;wrap_for_implicit_kwargs(function=</span><span class="si">%s</span><span class="s">, implicit_kwargs=</span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">)</span>
    <span class="n">args</span><span class="p">,</span> <span class="n">varargs</span><span class="p">,</span> <span class="n">varkwargs</span><span class="p">,</span> <span class="n">defaults</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;argspec = (args=</span><span class="si">%s</span><span class="s">,varargs=</span><span class="si">%s</span><span class="s">,varkwargs=</span><span class="si">%s</span><span class="s">,defaults=</span><span class="si">%s</span><span class="s">)&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">varargs</span><span class="p">,</span> <span class="n">varkwargs</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
    <span class="n">kwarg_index_value_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">implicit_kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
                               <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">implicit_kwargs</span> <span class="ow">and</span> <span class="n">validate_is_implicit</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">kwarg_index_value_pairs</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">call_with_implicit_kwargs</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;call_with_implicit_kwargs wrapper used for a decorator&quot;&quot;&quot;</span>
            <span class="n">args_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwarg_index_value_pairs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">args_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">is</span> <span class="n">implicit</span><span class="p">:</span>
                    <span class="n">args_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args_list</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;wrap_for_implicit_kwargs decorating </span><span class="si">%s</span><span class="s"> with </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">kwarg_index_value_pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">call_with_implicit_kwargs</span><span class="p">,</span> <span class="n">function</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">function</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="sparktk.lazyloader.LazyLoader" class="name">class <span class="ident">LazyLoader</span></p>
      
  
    <div class="desc"><p>Building-block object used to build out on-demand access to library subpackages, modules, and module contents.</p>
<p>For a given file path, we build a custom class type (inheriting LazyLoader) which has properties to access each
child subpackage or module found in the path.  These properties in turn, when accessed during runtime, create
more lazy loader blocks for their descendents.  Only when module content is directly accessed does the module
hierarchy actually get imported.</p>
<p>Enables interactive script code, tabbing out the dots, like this:</p>
<p><code>tc.models.clustering.kmeans.train(...)</code></p>
<p>Where nothing is actually loaded until the content of the kmeans module is needed.</p>
<p>Also supports implicitly filling in function kwargs.  The lazy loader at creation time can be given a dict
of kwargs which it will use to fill in function calls when referenced off the lazy loader.  For example, we can
define the function:</p>
<div class="codehilite"><pre>def great_read(uri, config, tc=implicit):
   return tc.thing.read(uri, config)
</pre></div>


<p>If we lazily load great_read under tc somewhere, we'd like the tc to be passed implicitly, rather than
awkwardly specifying it again:</p>
<div class="codehilite"><pre>config = {&#39;x&#39;: 1, &#39;y&#39;: 2}
tc.readers.great_read(&#39;my_uri&#39;, config)  # no need to pass &#39;tc&#39;
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.lazyloader.LazyLoader', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.lazyloader.LazyLoader" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">LazyLoader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Building-block object used to build out on-demand access to library subpackages, modules, and module contents.</span>

<span class="sd">    For a given file path, we build a custom class type (inheriting LazyLoader) which has properties to access each</span>
<span class="sd">    child subpackage or module found in the path.  These properties in turn, when accessed during runtime, create</span>
<span class="sd">    more lazy loader blocks for their descendents.  Only when module content is directly accessed does the module</span>
<span class="sd">    hierarchy actually get imported.</span>

<span class="sd">    Enables interactive script code, tabbing out the dots, like this:</span>

<span class="sd">    ``tc.models.clustering.kmeans.train(...)``</span>

<span class="sd">    Where nothing is actually loaded until the content of the kmeans module is needed.</span>

<span class="sd">    Also supports implicitly filling in function kwargs.  The lazy loader at creation time can be given a dict</span>
<span class="sd">    of kwargs which it will use to fill in function calls when referenced off the lazy loader.  For example, we can</span>
<span class="sd">    define the function:</span>


<span class="sd">        def great_read(uri, config, tc=implicit):</span>
<span class="sd">           return tc.thing.read(uri, config)</span>

<span class="sd">    If we lazily load great_read under tc somewhere, we&#39;d like the tc to be passed implicitly, rather than</span>
<span class="sd">    awkwardly specifying it again:</span>

<span class="sd">        config = {&#39;x&#39;: 1, &#39;y&#39;: 2}</span>
<span class="sd">        tc.readers.great_read(&#39;my_uri&#39;, config)  # no need to pass &#39;tc&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#sparktk.lazyloader.LazyLoader">LazyLoader</a></li>
          <li>__builtin__.object</li>
          </ul>
      </div>
      </div>

  </section>

        </div>
        <div class="clear" />
        <footer id="footer">
          <div>
            spark-tk Python API Documentation
          </div>
        </footer>
      </article>
  </div>
</body>
</html>
