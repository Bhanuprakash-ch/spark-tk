<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>sparktk.graph.graph API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: Arial, Helvetica, sans;
    font-size: 14px;
  }
  #content {
    position: absolute;
    left: 25%;
    right: 0;
    top: 0;
    bottom: 0;
    overflow: auto;
    padding: 30px;
    height: 100%;
  }
  #sidebar {
    position: absolute;
    width: 25%;
    top: 0;
    right: 0;
    left: 0;
    padding: 30px;
    overflow: auto;
    height: 100%;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #fixed_top_left {
    display: block;
    position: fixed;
    top: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
    background: transparent;
    z-index: 1;  /* Set z-index so that it doesn't get lost behind the sidebar */
  }

  #footer {
    font-size: .75em;
    margin-top: 20px;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    font-size: 1.5em;
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name, .param-name {
    font-family: Consolas, "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }
  .section-header {
    font-weight: bold;
    padding: 10px 0 5px 0;
  }
  .param-name {
    font-weight: bold;
    text-align: left;
    vertical-align: top;
  }
  .param-type {
    font-style: italic;
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  .param-desc {
    text-align: left;
    vertical-align: top;
    padding-left: 5px;
  }
  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
      background: #f9f9f9;
      font-size: 13px;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 20px 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
  <a href="index.html" id="fixed_top_left">Up</a>
  <!--<a href="#" id="top">Top</a>-->
  <div id="container">
      
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#sparktk.graph.graph.create">create</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.import_orientdb_graph">import_orientdb_graph</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#sparktk.graph.graph.Graph">Graph</a></span>
        
          
  <ul>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.__init__">__init__</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.clustering_coefficient">clustering_coefficient</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.connected_components">connected_components</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.create_edges_frame">create_edges_frame</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.create_vertices_frame">create_vertices_frame</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.degrees">degrees</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.export_to_orientdb">export_to_orientdb</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.global_clustering_coefficient">global_clustering_coefficient</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.label_propagation">label_propagation</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.loopy_belief_propagation">loopy_belief_propagation</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.page_rank">page_rank</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.save">save</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.triangle_count">triangle_count</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.vertex_count">vertex_count</a></li>
    <li class="mono"><a href="#sparktk.graph.graph.Graph.weighted_degrees">weighted_degrees</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

      <article id="content">
        <div>
        
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">sparktk.graph.graph</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph" class="source">
    <div class="codehilite"><pre><span class="c"># vim: set encoding=utf-8</span>

<span class="c">#  Copyright (c) 2016 Intel Corporation </span>
<span class="c">#</span>
<span class="c">#  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c">#  you may not use this file except in compliance with the License.</span>
<span class="c">#  You may obtain a copy of the License at</span>
<span class="c">#</span>
<span class="c">#       http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c">#</span>
<span class="c">#  Unless required by applicable law or agreed to in writing, software</span>
<span class="c">#  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c">#  See the License for the specific language governing permissions and</span>
<span class="c">#  limitations under the License.</span>
<span class="c">#</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;sparktk&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">graphframes.graphframe</span> <span class="kn">import</span> <span class="n">GraphFrame</span><span class="p">,</span> <span class="n">_from_java_gf</span>
<span class="kn">from</span> <span class="nn">py4j.protocol</span> <span class="kn">import</span> <span class="n">Py4JJavaError</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.utils</span> <span class="kn">import</span> <span class="n">IllegalArgumentException</span>
<span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
<span class="kn">from</span> <span class="nn">sparktk.arguments</span> <span class="kn">import</span> <span class="n">require_type</span>


<span class="c"># import constructors for the API&#39;s sake (not actually dependencies of the Graph)</span>
<span class="kn">from</span> <span class="nn">sparktk.graph.constructors.create</span> <span class="kn">import</span> <span class="n">create</span>
<span class="kn">from</span> <span class="nn">sparktk.graph.constructors.import_orientdb_graph</span> <span class="kn">import</span> <span class="n">import_orientdb_graph</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;create&quot;</span><span class="p">,</span>
           <span class="s">&quot;Graph&quot;</span><span class="p">,</span>
           <span class="s">&quot;import_orientdb_graph&quot;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Graph</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sparktk Graph</span>

<span class="sd">    Represents a graph with a frame defining vertices and another frame defining edges.  It is implemented as a very</span>
<span class="sd">    thin wrapper of the spark GraphFrame (https://github.com/graphframes/graphframes) onto which additional methods</span>
<span class="sd">    are available.</span>

<span class="sd">    A vertices frame defines the vertices for the graph and must have a schema with a column</span>
<span class="sd">    named &quot;id&quot; which provides unique vertex ID.  All other columns are treated as vertex properties.</span>
<span class="sd">    If a column is also found named &quot;vertex_type&quot;, it will be used as a special label to denote the type</span>
<span class="sd">    of vertex, for example, when interfacing with logic (such as a graph DB) which expects a</span>
<span class="sd">    specific vertex type.</span>

<span class="sd">    An edge frame defines the edges of the graph; schema must have columns names &quot;src&quot; and &quot;dst&quot; which provide the</span>
<span class="sd">    vertex ids of the edge.  All other columns are treated as edge properties.  If a column is also found named</span>
<span class="sd">    &quot;edge_type&quot;, it will be used as a special label to denote the type of edge, for example, when interfacing with logic</span>
<span class="sd">    (such as a graph DB) which expects a specific edge type.</span>

<span class="sd">    Unlike sparktk Frames, this Graph is immutable (it cannot be changed).  The vertices and edges may be extracted as</span>
<span class="sd">    sparktk Frame objects, but those frames then take on a life of their own apart from this graph object.  Those frames</span>
<span class="sd">    could be transformed and used to build a new graph object if necessary.</span>

<span class="sd">    The underlying spark GraphFrame is available as the &#39;graphframe&#39; property of this object.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; viewers = tc.frame.create([[&#39;fred&#39;, 0],</span>
<span class="sd">        ...                            [&#39;wilma&#39;, 0],</span>
<span class="sd">        ...                            [&#39;pebbles&#39;, 1],</span>
<span class="sd">        ...                            [&#39;betty&#39;, 0],</span>
<span class="sd">        ...                            [&#39;barney&#39;, 0],</span>
<span class="sd">        ...                            [&#39;bamm bamm&#39;, 1]],</span>
<span class="sd">        ...                           schema= [(&#39;id&#39;, str), (&#39;kids&#39;, int)])</span>

<span class="sd">        &gt;&gt;&gt; titles = [&#39;Croods&#39;, &#39;Jurassic Park&#39;, &#39;2001&#39;, &#39;Ice Age&#39;, &#39;Land Before Time&#39;]</span>

<span class="sd">        &gt;&gt;&gt; movies = tc.frame.create([[t] for t in titles], schema=[(&#39;id&#39;, str)])</span>

<span class="sd">        &gt;&gt;&gt; vertices = viewers.copy()</span>

<span class="sd">        &gt;&gt;&gt; vertices.append(movies)</span>

<span class="sd">        &gt;&gt;&gt; vertices.inspect(20)</span>
<span class="sd">        [##]  id                kids</span>
<span class="sd">        ============================</span>
<span class="sd">        [0]   fred                 0</span>
<span class="sd">        [1]   wilma                0</span>
<span class="sd">        [2]   pebbles              1</span>
<span class="sd">        [3]   betty                0</span>
<span class="sd">        [4]   barney               0</span>
<span class="sd">        [5]   bamm bamm            1</span>
<span class="sd">        [6]   Croods            None</span>
<span class="sd">        [7]   Jurassic Park     None</span>
<span class="sd">        [8]   2001              None</span>
<span class="sd">        [9]   Ice Age           None</span>
<span class="sd">        [10]  Land Before Time  None</span>

<span class="sd">        &gt;&gt;&gt; edges = tc.frame.create([[&#39;fred&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;Jurassic Park&#39;,5],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;2001&#39;,2],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;Ice Age&#39;,4],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;Jurassic Park&#39;,3],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;2001&#39;,5],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;Ice Age&#39;,4],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Croods&#39;,4],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Land Before Time&#39;,3],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Ice Age&#39;,5],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Jurassic Park&#39;,3],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Land Before Time&#39;,4],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Ice Age&#39;,3],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Jurassic Park&#39;,5],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Land Before Time&#39;,3],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Ice Age&#39;,5],</span>
<span class="sd">        ...                          [&#39;bamm bamm&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;bamm bamm&#39;,&#39;Land Before Time&#39;,3]],</span>
<span class="sd">        ...                         schema = [&#39;src&#39;, &#39;dst&#39;, &#39;rating&#39;])</span>

<span class="sd">        &gt;&gt;&gt; edges.inspect(20)</span>
<span class="sd">        [##]  src        dst               rating</span>
<span class="sd">        =========================================</span>
<span class="sd">        [0]   fred       Croods                 5</span>
<span class="sd">        [1]   fred       Jurassic Park          5</span>
<span class="sd">        [2]   fred       2001                   2</span>
<span class="sd">        [3]   fred       Ice Age                4</span>
<span class="sd">        [4]   wilma      Jurassic Park          3</span>
<span class="sd">        [5]   wilma      2001                   5</span>
<span class="sd">        [6]   wilma      Ice Age                4</span>
<span class="sd">        [7]   pebbles    Croods                 4</span>
<span class="sd">        [8]   pebbles    Land Before Time       3</span>
<span class="sd">        [9]   pebbles    Ice Age                5</span>
<span class="sd">        [10]  betty      Croods                 5</span>
<span class="sd">        [11]  betty      Jurassic Park          3</span>
<span class="sd">        [12]  betty      Land Before Time       4</span>
<span class="sd">        [13]  betty      Ice Age                3</span>
<span class="sd">        [14]  barney     Croods                 5</span>
<span class="sd">        [15]  barney     Jurassic Park          5</span>
<span class="sd">        [16]  barney     Land Before Time       3</span>
<span class="sd">        [17]  barney     Ice Age                5</span>
<span class="sd">        [18]  bamm bamm  Croods                 5</span>
<span class="sd">        [19]  bamm bamm  Land Before Time       3</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertices, edges)</span>

<span class="sd">        &gt;&gt;&gt; graph</span>
<span class="sd">        Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])</span>


<span class="sd">        &gt;&gt;&gt; graph.save(&quot;sandbox/old_movie_graph&quot;)</span>

<span class="sd">        &gt;&gt;&gt; restored = tc.load(&quot;sandbox/old_movie_graph&quot;)</span>

<span class="sd">        &gt;&gt;&gt; restored</span>
<span class="sd">        Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">edges_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span> <span class="o">=</span> <span class="n">tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># (note that the Scala code will validate appropriate frame schemas)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">Frame</span><span class="p">):</span>
            <span class="c"># Python Vertices and Edges Frames</span>
            <span class="n">vertices_frame</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
            <span class="n">require_type</span><span class="p">(</span><span class="n">Frame</span><span class="p">,</span>
                         <span class="n">edges_frame</span><span class="p">,</span>
                         <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                         <span class="s">&quot;Providing a vertices frame requires also providing an edges frame&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span>
                                                                     <span class="n">vertices_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">,</span>
                                                                     <span class="n">edges_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
            <span class="n">require_type</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">edges_frame</span><span class="p">,</span>
                         <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                         <span class="s">&#39;If edges_frames is provided, then a valid vertex frame must be provided as the first arg, instead of type </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graph</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="c"># Scala Graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="n">source</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">GraphFrame</span><span class="p">):</span>
                <span class="c"># python GraphFrame</span>
                <span class="n">scala_graphframe</span> <span class="o">=</span>  <span class="n">source</span><span class="o">.</span><span class="n">_jvm_graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">scala_graphframe</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graphframe</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="c"># scala GraphFrame</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Cannot create from source type </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_scala_graph_class</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets reference to the sparktk scala Graph class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_scala_graphframe_class</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets reference to the scala GraphFrame class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">graphframes</span><span class="o">.</span><span class="n">GraphFrame</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graphframe</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">scala_graphframe</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">Py4JJavaError</span><span class="p">,</span> <span class="n">IllegalArgumentException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_scala_graph_from_scala_frames</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_vertices_frame</span><span class="p">,</span> <span class="n">scala_edges_frame</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">constructors</span><span class="o">.</span><span class="n">FromFrames</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">scala_vertices_frame</span><span class="p">,</span> <span class="n">scala_edges_frame</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">Py4JJavaError</span><span class="p">,</span> <span class="n">IllegalArgumentException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c"># this one for the Loader:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_from_scala</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graph</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;creates a python Frame for the given scala Frame&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graph</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_is_scala_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">is_jvm_instance_of</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scala_graph_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_is_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">is_jvm_instance_of</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scala_graphframe_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">))</span>

    <span class="c">##########################################################################</span>
    <span class="c"># API</span>
    <span class="c">##########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">graphframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The underlying graphframe object which exposes several methods and properties&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_from_java_gf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">sql_context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_vertices_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a frame representing the vertices stored in this graph&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
        <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">create_edges_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a frame representing the edges stored in this graph&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
        <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="c"># Graph Operations</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.connected_components</span> <span class="kn">import</span> <span class="n">connected_components</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.clustering_coefficient</span> <span class="kn">import</span> <span class="n">clustering_coefficient</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.degrees</span> <span class="kn">import</span> <span class="n">degrees</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.export_to_orientdb</span> <span class="kn">import</span> <span class="n">export_to_orientdb</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.global_clustering_coefficient</span> <span class="kn">import</span> <span class="n">global_clustering_coefficient</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.label_propagation</span> <span class="kn">import</span> <span class="n">label_propagation</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.loopy_belief_propagation</span> <span class="kn">import</span> <span class="n">loopy_belief_propagation</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.page_rank</span> <span class="kn">import</span> <span class="n">page_rank</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.save</span> <span class="kn">import</span> <span class="n">save</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.triangle_count</span> <span class="kn">import</span> <span class="n">triangle_count</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.vertex_count</span> <span class="kn">import</span> <span class="n">vertex_count</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.weighted_degrees</span> <span class="kn">import</span> <span class="n">weighted_degrees</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.create">
    <p>def <span class="ident">create</span>(</p><p>source_or_vertices_frame, edges_frame=None, tc=&lt;class &#39;sparktk.arguments.implicit&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a sparktk Graph from two sparktk Frames (or some other source)</p>
<div class='section-header'>Parameters:</div>

<table><tr><td class='param-name'>source_or_vertices_frame: </td><td class='param-desc'>a graph source or a vertices frame
                    Valid sources include: a python and spark GraphFrame, or a scala Graph
                    Otherwise if a vertices frame is provided, then the edges_frame arg must also be supplied.
                    A vertices frame defines the vertices for the graph and must have a schema with a column
                    named "id" which provides unique vertex ID.  All other columns are treated as vertex properties.
                    If a column is also found named "vertex_type", it will be used as a special label to denote the
                    type of vertex, for example, when interfacing with logic (such as a graph DB) which expects a
                    specific vertex type.</td></tr></table>

<table><tr><td class='param-name'>edges_frame</td><td class='param-type'>(valid only if the source_or_vertices_frame arg is a vertices Frame):</td><td class='param-desc'>An edge frame defines the
                    edges of the graph; schema must have columns names "src" and "dst" which provide the vertex ids
                    of the edge.  All other columns are treated as edge properties.  If a column is also found named
                    "edge_type", it will be used as a special label to denote the type of edge, for example, when
                    interfacing with logic (such as a graph DB) which expects a specific edge type.</td></tr></table></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.create', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.create" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">edges_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tc</span><span class="o">=</span><span class="n">TkContext</span><span class="o">.</span><span class="n">implicit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a sparktk Graph from two sparktk Frames (or some other source)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    :param source_or_vertices_frame: a graph source or a vertices frame</span>
<span class="sd">                        Valid sources include: a python and spark GraphFrame, or a scala Graph</span>
<span class="sd">                        Otherwise if a vertices frame is provided, then the edges_frame arg must also be supplied.</span>
<span class="sd">                        A vertices frame defines the vertices for the graph and must have a schema with a column</span>
<span class="sd">                        named &quot;id&quot; which provides unique vertex ID.  All other columns are treated as vertex properties.</span>
<span class="sd">                        If a column is also found named &quot;vertex_type&quot;, it will be used as a special label to denote the</span>
<span class="sd">                        type of vertex, for example, when interfacing with logic (such as a graph DB) which expects a</span>
<span class="sd">                        specific vertex type.</span>

<span class="sd">    :param edges_frame: (valid only if the source_or_vertices_frame arg is a vertices Frame) An edge frame defines the</span>
<span class="sd">                        edges of the graph; schema must have columns names &quot;src&quot; and &quot;dst&quot; which provide the vertex ids</span>
<span class="sd">                        of the edge.  All other columns are treated as edge properties.  If a column is also found named</span>
<span class="sd">                        &quot;edge_type&quot;, it will be used as a special label to denote the type of edge, for example, when</span>
<span class="sd">                        interfacing with logic (such as a graph DB) which expects a specific edge type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TkContext</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.graph</span> <span class="kn">import</span> <span class="n">Graph</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">edges_frame</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.import_orientdb_graph">
    <p>def <span class="ident">import_orientdb_graph</span>(</p><p>db_url, user_name, password, root_password, tc=&lt;class &#39;sparktk.arguments.implicit&#39;&gt;)</p>
    </div>
    

    
  
    <div class="desc"><p>Import graph from OrientDB to spark-tk as spark-tk graph (Spark GraphFrame)</p>
<div class="codehilite"><pre><span class="gh">Parameters</span>
<span class="gh">----------</span>
<span class="nc">:param:(str) db_url:</span> <span class="nf">OrientDB URI</span>
<span class="nc">:param:(str) user_name:</span> <span class="nf">the database username</span>
<span class="nc">:param:(str) password:</span> <span class="nf">the database password</span>
<span class="nc">:param :(str)root_password:</span> <span class="nf">OrientDB server password</span>

<span class="gh">Example</span>
<span class="gh">-------</span>

   &gt;&gt;&gt; v = tc.frame.create([(&quot;a&quot;, &quot;Alice&quot;, 34,&quot;F&quot;),
<span class="cp">    ...     (&quot;b&quot;, &quot;Bob&quot;, 36,&quot;M&quot;),</span>
<span class="cp">    ...     (&quot;c&quot;, &quot;Charlie&quot;, 30,&quot;M&quot;),</span>
<span class="cp">    ...     (&quot;d&quot;, &quot;David&quot;, 29,&quot;M&quot;),</span>
<span class="cp">    ...     (&quot;e&quot;, &quot;Esther&quot;, 32,&quot;F&quot;),</span>
<span class="cp">    ...     (&quot;f&quot;, &quot;Fanny&quot;, 36,&quot;F&quot;),</span>
<span class="cp">    ...     ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;,&quot;gender&quot;])</span>

<span class="cp">    &gt;&gt;&gt; e = tc.frame.create([(&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),</span>
<span class="cp">    ...     (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="cp">    ...     (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),</span>
<span class="cp">    ...     (&quot;f&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="cp">    ...     (&quot;e&quot;, &quot;f&quot;, &quot;follow&quot;),</span>
<span class="cp">    ...     (&quot;e&quot;, &quot;d&quot;, &quot;friend&quot;),</span>
<span class="cp">    ...     (&quot;d&quot;, &quot;a&quot;, &quot;friend&quot;),</span>
<span class="cp">    ...     (&quot;a&quot;, &quot;e&quot;, &quot;friend&quot;)</span>
<span class="cp">    ...     ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])</span>

<span class="cp">    &gt;&gt;&gt; sparktk_graph = tc.graph.create(v,e)</span>

<span class="cp">    &gt;&gt;&gt; db = &quot;test_db&quot;</span>

<span class="cp">    &gt;&gt;&gt; sparktk_graph.export_to_orientdb(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;,vertex_type_column_name= &quot;gender&quot;,edge_type_column_name=&quot;relationship&quot;)</span>

<span class="cp">    &gt;&gt;&gt; imported_gf = tc.graph.import_orientdb_graph(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;)</span>

<span class="cp">    &gt;&gt;&gt; imported_gf.graphframe.vertices.show()</span>
</pre></div>


<p>+-------+------+---+---+
|   name|gender| id|age|
+-------+------+---+---+
|    Bob|     M|  b| 36|
|  David|     M|  d| 29|
|Charlie|     M|  c| 30|
|  Alice|     F|  a| 34|
| Esther|     F|  e| 32|
|  Fanny|     F|  f| 36|
+-------+------+---+---+</p>
<div class="codehilite"><pre>    &gt;&gt;&gt; imported_gf.graphframe.edges.show()
</pre></div>


<p>+---+------------+---+
|dst|relationship|src|
+---+------------+---+
|  f|      follow|  e|
|  b|      follow|  c|
|  c|      follow|  b|
|  c|      follow|  f|
|  b|      friend|  a|
|  a|      friend|  d|
|  d|      friend|  e|
|  e|      friend|  a|
+---+------------+---+</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.import_orientdb_graph', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.import_orientdb_graph" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">import_orientdb_graph</span><span class="p">(</span><span class="n">db_url</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">root_password</span><span class="p">,</span><span class="n">tc</span><span class="o">=</span><span class="n">TkContext</span><span class="o">.</span><span class="n">implicit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Import graph from OrientDB to spark-tk as spark-tk graph (Spark GraphFrame)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    :param:(str) db_url: OrientDB URI</span>
<span class="sd">    :param:(str) user_name: the database username</span>
<span class="sd">    :param:(str) password: the database password</span>
<span class="sd">    :param :(str)root_password: OrientDB server password</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">       &gt;&gt;&gt; v = tc.frame.create([(&quot;a&quot;, &quot;Alice&quot;, 34,&quot;F&quot;),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;Bob&quot;, 36,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;Charlie&quot;, 30,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;David&quot;, 29,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;Esther&quot;, 32,&quot;F&quot;),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;Fanny&quot;, 36,&quot;F&quot;),</span>
<span class="sd">        ...     ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;,&quot;gender&quot;])</span>

<span class="sd">        &gt;&gt;&gt; e = tc.frame.create([(&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;f&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;d&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;a&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;a&quot;, &quot;e&quot;, &quot;friend&quot;)</span>
<span class="sd">        ...     ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])</span>

<span class="sd">        &gt;&gt;&gt; sparktk_graph = tc.graph.create(v,e)</span>

<span class="sd">        &gt;&gt;&gt; db = &quot;test_db&quot;</span>

<span class="sd">        &gt;&gt;&gt; sparktk_graph.export_to_orientdb(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;,vertex_type_column_name= &quot;gender&quot;,edge_type_column_name=&quot;relationship&quot;)</span>

<span class="sd">        &gt;&gt;&gt; imported_gf = tc.graph.import_orientdb_graph(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;)</span>

<span class="sd">        &gt;&gt;&gt; imported_gf.graphframe.vertices.show()</span>

<span class="sd">+-------+------+---+---+</span>
<span class="sd">|   name|gender| id|age|</span>
<span class="sd">+-------+------+---+---+</span>
<span class="sd">|    Bob|     M|  b| 36|</span>
<span class="sd">|  David|     M|  d| 29|</span>
<span class="sd">|Charlie|     M|  c| 30|</span>
<span class="sd">|  Alice|     F|  a| 34|</span>
<span class="sd">| Esther|     F|  e| 32|</span>
<span class="sd">|  Fanny|     F|  f| 36|</span>
<span class="sd">+-------+------+---+---+</span>

<span class="sd">        &gt;&gt;&gt; imported_gf.graphframe.edges.show()</span>

<span class="sd">+---+------------+---+</span>
<span class="sd">|dst|relationship|src|</span>
<span class="sd">+---+------------+---+</span>
<span class="sd">|  f|      follow|  e|</span>
<span class="sd">|  b|      follow|  c|</span>
<span class="sd">|  c|      follow|  b|</span>
<span class="sd">|  c|      follow|  f|</span>
<span class="sd">|  b|      friend|  a|</span>
<span class="sd">|  a|      friend|  d|</span>
<span class="sd">|  d|      friend|  e|</span>
<span class="sd">|  e|      friend|  a|</span>
<span class="sd">+---+------------+---+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TkContext</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">tc</span><span class="p">)</span>
    <span class="n">scala_graph</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">constructors</span><span class="o">.</span><span class="n">fromorientdb</span><span class="o">.</span><span class="n">ImportFromOrientdb</span><span class="o">.</span><span class="n">importOrientdbGraph</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">jutils</span><span class="o">.</span><span class="n">get_scala_sc</span><span class="p">(),</span> <span class="n">db_url</span><span class="p">,</span><span class="n">user_name</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="n">root_password</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.graph</span> <span class="kn">import</span> <span class="n">Graph</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graph</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="sparktk.graph.graph.Graph" class="name">class <span class="ident">Graph</span></p>
      
  
    <div class="desc"><p>sparktk Graph</p>
<p>Represents a graph with a frame defining vertices and another frame defining edges.  It is implemented as a very
thin wrapper of the spark GraphFrame (https://github.com/graphframes/graphframes) onto which additional methods
are available.</p>
<p>A vertices frame defines the vertices for the graph and must have a schema with a column
named "id" which provides unique vertex ID.  All other columns are treated as vertex properties.
If a column is also found named "vertex_type", it will be used as a special label to denote the type
of vertex, for example, when interfacing with logic (such as a graph DB) which expects a
specific vertex type.</p>
<p>An edge frame defines the edges of the graph; schema must have columns names "src" and "dst" which provide the
vertex ids of the edge.  All other columns are treated as edge properties.  If a column is also found named
"edge_type", it will be used as a special label to denote the type of edge, for example, when interfacing with logic
(such as a graph DB) which expects a specific edge type.</p>
<p>Unlike sparktk Frames, this Graph is immutable (it cannot be changed).  The vertices and edges may be extracted as
sparktk Frame objects, but those frames then take on a life of their own apart from this graph object.  Those frames
could be transformed and used to build a new graph object if necessary.</p>
<p>The underlying spark GraphFrame is available as the 'graphframe' property of this object.</p>
<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; viewers = tc.frame.create([[&#39;fred&#39;, 0],
...                            [&#39;wilma&#39;, 0],
...                            [&#39;pebbles&#39;, 1],
...                            [&#39;betty&#39;, 0],
...                            [&#39;barney&#39;, 0],
...                            [&#39;bamm bamm&#39;, 1]],
...                           schema= [(&#39;id&#39;, str), (&#39;kids&#39;, int)])

&gt;&gt;&gt; titles = [&#39;Croods&#39;, &#39;Jurassic Park&#39;, &#39;2001&#39;, &#39;Ice Age&#39;, &#39;Land Before Time&#39;]

&gt;&gt;&gt; movies = tc.frame.create([[t] for t in titles], schema=[(&#39;id&#39;, str)])

&gt;&gt;&gt; vertices = viewers.copy()

&gt;&gt;&gt; vertices.append(movies)

&gt;&gt;&gt; vertices.inspect(20)
[##]  id                kids
============================
[0]   fred                 0
[1]   wilma                0
[2]   pebbles              1
[3]   betty                0
[4]   barney               0
[5]   bamm bamm            1
[6]   Croods            None
[7]   Jurassic Park     None
[8]   2001              None
[9]   Ice Age           None
[10]  Land Before Time  None

&gt;&gt;&gt; edges = tc.frame.create([[&#39;fred&#39;,&#39;Croods&#39;,5],
...                          [&#39;fred&#39;,&#39;Jurassic Park&#39;,5],
...                          [&#39;fred&#39;,&#39;2001&#39;,2],
...                          [&#39;fred&#39;,&#39;Ice Age&#39;,4],
...                          [&#39;wilma&#39;,&#39;Jurassic Park&#39;,3],
...                          [&#39;wilma&#39;,&#39;2001&#39;,5],
...                          [&#39;wilma&#39;,&#39;Ice Age&#39;,4],
...                          [&#39;pebbles&#39;,&#39;Croods&#39;,4],
...                          [&#39;pebbles&#39;,&#39;Land Before Time&#39;,3],
...                          [&#39;pebbles&#39;,&#39;Ice Age&#39;,5],
...                          [&#39;betty&#39;,&#39;Croods&#39;,5],
...                          [&#39;betty&#39;,&#39;Jurassic Park&#39;,3],
...                          [&#39;betty&#39;,&#39;Land Before Time&#39;,4],
...                          [&#39;betty&#39;,&#39;Ice Age&#39;,3],
...                          [&#39;barney&#39;,&#39;Croods&#39;,5],
...                          [&#39;barney&#39;,&#39;Jurassic Park&#39;,5],
...                          [&#39;barney&#39;,&#39;Land Before Time&#39;,3],
...                          [&#39;barney&#39;,&#39;Ice Age&#39;,5],
...                          [&#39;bamm bamm&#39;,&#39;Croods&#39;,5],
...                          [&#39;bamm bamm&#39;,&#39;Land Before Time&#39;,3]],
...                         schema = [&#39;src&#39;, &#39;dst&#39;, &#39;rating&#39;])

&gt;&gt;&gt; edges.inspect(20)
[##]  src        dst               rating
=========================================
[0]   fred       Croods                 5
[1]   fred       Jurassic Park          5
[2]   fred       2001                   2
[3]   fred       Ice Age                4
[4]   wilma      Jurassic Park          3
[5]   wilma      2001                   5
[6]   wilma      Ice Age                4
[7]   pebbles    Croods                 4
[8]   pebbles    Land Before Time       3
[9]   pebbles    Ice Age                5
[10]  betty      Croods                 5
[11]  betty      Jurassic Park          3
[12]  betty      Land Before Time       4
[13]  betty      Ice Age                3
[14]  barney     Croods                 5
[15]  barney     Jurassic Park          5
[16]  barney     Land Before Time       3
[17]  barney     Ice Age                5
[18]  bamm bamm  Croods                 5
[19]  bamm bamm  Land Before Time       3

&gt;&gt;&gt; graph = tc.graph.create(vertices, edges)

&gt;&gt;&gt; graph
Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])


&gt;&gt;&gt; graph.save(&quot;sandbox/old_movie_graph&quot;)

&gt;&gt;&gt; restored = tc.load(&quot;sandbox/old_movie_graph&quot;)

&gt;&gt;&gt; restored
Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph" class="source">
    <div class="codehilite"><pre><span class="k">class</span> <span class="nc">Graph</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sparktk Graph</span>

<span class="sd">    Represents a graph with a frame defining vertices and another frame defining edges.  It is implemented as a very</span>
<span class="sd">    thin wrapper of the spark GraphFrame (https://github.com/graphframes/graphframes) onto which additional methods</span>
<span class="sd">    are available.</span>

<span class="sd">    A vertices frame defines the vertices for the graph and must have a schema with a column</span>
<span class="sd">    named &quot;id&quot; which provides unique vertex ID.  All other columns are treated as vertex properties.</span>
<span class="sd">    If a column is also found named &quot;vertex_type&quot;, it will be used as a special label to denote the type</span>
<span class="sd">    of vertex, for example, when interfacing with logic (such as a graph DB) which expects a</span>
<span class="sd">    specific vertex type.</span>

<span class="sd">    An edge frame defines the edges of the graph; schema must have columns names &quot;src&quot; and &quot;dst&quot; which provide the</span>
<span class="sd">    vertex ids of the edge.  All other columns are treated as edge properties.  If a column is also found named</span>
<span class="sd">    &quot;edge_type&quot;, it will be used as a special label to denote the type of edge, for example, when interfacing with logic</span>
<span class="sd">    (such as a graph DB) which expects a specific edge type.</span>

<span class="sd">    Unlike sparktk Frames, this Graph is immutable (it cannot be changed).  The vertices and edges may be extracted as</span>
<span class="sd">    sparktk Frame objects, but those frames then take on a life of their own apart from this graph object.  Those frames</span>
<span class="sd">    could be transformed and used to build a new graph object if necessary.</span>

<span class="sd">    The underlying spark GraphFrame is available as the &#39;graphframe&#39; property of this object.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; viewers = tc.frame.create([[&#39;fred&#39;, 0],</span>
<span class="sd">        ...                            [&#39;wilma&#39;, 0],</span>
<span class="sd">        ...                            [&#39;pebbles&#39;, 1],</span>
<span class="sd">        ...                            [&#39;betty&#39;, 0],</span>
<span class="sd">        ...                            [&#39;barney&#39;, 0],</span>
<span class="sd">        ...                            [&#39;bamm bamm&#39;, 1]],</span>
<span class="sd">        ...                           schema= [(&#39;id&#39;, str), (&#39;kids&#39;, int)])</span>

<span class="sd">        &gt;&gt;&gt; titles = [&#39;Croods&#39;, &#39;Jurassic Park&#39;, &#39;2001&#39;, &#39;Ice Age&#39;, &#39;Land Before Time&#39;]</span>

<span class="sd">        &gt;&gt;&gt; movies = tc.frame.create([[t] for t in titles], schema=[(&#39;id&#39;, str)])</span>

<span class="sd">        &gt;&gt;&gt; vertices = viewers.copy()</span>

<span class="sd">        &gt;&gt;&gt; vertices.append(movies)</span>

<span class="sd">        &gt;&gt;&gt; vertices.inspect(20)</span>
<span class="sd">        [##]  id                kids</span>
<span class="sd">        ============================</span>
<span class="sd">        [0]   fred                 0</span>
<span class="sd">        [1]   wilma                0</span>
<span class="sd">        [2]   pebbles              1</span>
<span class="sd">        [3]   betty                0</span>
<span class="sd">        [4]   barney               0</span>
<span class="sd">        [5]   bamm bamm            1</span>
<span class="sd">        [6]   Croods            None</span>
<span class="sd">        [7]   Jurassic Park     None</span>
<span class="sd">        [8]   2001              None</span>
<span class="sd">        [9]   Ice Age           None</span>
<span class="sd">        [10]  Land Before Time  None</span>

<span class="sd">        &gt;&gt;&gt; edges = tc.frame.create([[&#39;fred&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;Jurassic Park&#39;,5],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;2001&#39;,2],</span>
<span class="sd">        ...                          [&#39;fred&#39;,&#39;Ice Age&#39;,4],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;Jurassic Park&#39;,3],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;2001&#39;,5],</span>
<span class="sd">        ...                          [&#39;wilma&#39;,&#39;Ice Age&#39;,4],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Croods&#39;,4],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Land Before Time&#39;,3],</span>
<span class="sd">        ...                          [&#39;pebbles&#39;,&#39;Ice Age&#39;,5],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Jurassic Park&#39;,3],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Land Before Time&#39;,4],</span>
<span class="sd">        ...                          [&#39;betty&#39;,&#39;Ice Age&#39;,3],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Jurassic Park&#39;,5],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Land Before Time&#39;,3],</span>
<span class="sd">        ...                          [&#39;barney&#39;,&#39;Ice Age&#39;,5],</span>
<span class="sd">        ...                          [&#39;bamm bamm&#39;,&#39;Croods&#39;,5],</span>
<span class="sd">        ...                          [&#39;bamm bamm&#39;,&#39;Land Before Time&#39;,3]],</span>
<span class="sd">        ...                         schema = [&#39;src&#39;, &#39;dst&#39;, &#39;rating&#39;])</span>

<span class="sd">        &gt;&gt;&gt; edges.inspect(20)</span>
<span class="sd">        [##]  src        dst               rating</span>
<span class="sd">        =========================================</span>
<span class="sd">        [0]   fred       Croods                 5</span>
<span class="sd">        [1]   fred       Jurassic Park          5</span>
<span class="sd">        [2]   fred       2001                   2</span>
<span class="sd">        [3]   fred       Ice Age                4</span>
<span class="sd">        [4]   wilma      Jurassic Park          3</span>
<span class="sd">        [5]   wilma      2001                   5</span>
<span class="sd">        [6]   wilma      Ice Age                4</span>
<span class="sd">        [7]   pebbles    Croods                 4</span>
<span class="sd">        [8]   pebbles    Land Before Time       3</span>
<span class="sd">        [9]   pebbles    Ice Age                5</span>
<span class="sd">        [10]  betty      Croods                 5</span>
<span class="sd">        [11]  betty      Jurassic Park          3</span>
<span class="sd">        [12]  betty      Land Before Time       4</span>
<span class="sd">        [13]  betty      Ice Age                3</span>
<span class="sd">        [14]  barney     Croods                 5</span>
<span class="sd">        [15]  barney     Jurassic Park          5</span>
<span class="sd">        [16]  barney     Land Before Time       3</span>
<span class="sd">        [17]  barney     Ice Age                5</span>
<span class="sd">        [18]  bamm bamm  Croods                 5</span>
<span class="sd">        [19]  bamm bamm  Land Before Time       3</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertices, edges)</span>

<span class="sd">        &gt;&gt;&gt; graph</span>
<span class="sd">        Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])</span>


<span class="sd">        &gt;&gt;&gt; graph.save(&quot;sandbox/old_movie_graph&quot;)</span>

<span class="sd">        &gt;&gt;&gt; restored = tc.load(&quot;sandbox/old_movie_graph&quot;)</span>

<span class="sd">        &gt;&gt;&gt; restored</span>
<span class="sd">        Graph(v:[id: string, kids: int], e:[src: string, dst: string, rating: int])</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">edges_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span> <span class="o">=</span> <span class="n">tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># (note that the Scala code will validate appropriate frame schemas)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">Frame</span><span class="p">):</span>
            <span class="c"># Python Vertices and Edges Frames</span>
            <span class="n">vertices_frame</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
            <span class="n">require_type</span><span class="p">(</span><span class="n">Frame</span><span class="p">,</span>
                         <span class="n">edges_frame</span><span class="p">,</span>
                         <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                         <span class="s">&quot;Providing a vertices frame requires also providing an edges frame&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span>
                                                                     <span class="n">vertices_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">,</span>
                                                                     <span class="n">edges_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
            <span class="n">require_type</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">edges_frame</span><span class="p">,</span>
                         <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                         <span class="s">&#39;If edges_frames is provided, then a valid vertex frame must be provided as the first arg, instead of type </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graph</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="c"># Scala Graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="n">source</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">GraphFrame</span><span class="p">):</span>
                <span class="c"># python GraphFrame</span>
                <span class="n">scala_graphframe</span> <span class="o">=</span>  <span class="n">source</span><span class="o">.</span><span class="n">_jvm_graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">scala_graphframe</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graphframe</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="c"># scala GraphFrame</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Cannot create from source type </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_scala_graph_class</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets reference to the sparktk scala Graph class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_scala_graphframe_class</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets reference to the scala GraphFrame class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">graphframes</span><span class="o">.</span><span class="n">GraphFrame</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graphframe</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">scala_graphframe</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">Py4JJavaError</span><span class="p">,</span> <span class="n">IllegalArgumentException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_scala_graph_from_scala_frames</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_vertices_frame</span><span class="p">,</span> <span class="n">scala_edges_frame</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tc</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">_jvm</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">trustedanalytics</span><span class="o">.</span><span class="n">sparktk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">constructors</span><span class="o">.</span><span class="n">FromFrames</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">scala_vertices_frame</span><span class="p">,</span> <span class="n">scala_edges_frame</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">Py4JJavaError</span><span class="p">,</span> <span class="n">IllegalArgumentException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c"># this one for the Loader:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_from_scala</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graph</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;creates a python Frame for the given scala Frame&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">scala_graph</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_is_scala_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">is_jvm_instance_of</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scala_graph_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_is_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">is_jvm_instance_of</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scala_graphframe_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">))</span>

    <span class="c">##########################################################################</span>
    <span class="c"># API</span>
    <span class="c">##########################################################################</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">graphframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The underlying graphframe object which exposes several methods and properties&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_from_java_gf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">sql_context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_vertices_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a frame representing the vertices stored in this graph&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
        <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">create_edges_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a frame representing the edges stored in this graph&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
        <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="c"># Graph Operations</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.connected_components</span> <span class="kn">import</span> <span class="n">connected_components</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.clustering_coefficient</span> <span class="kn">import</span> <span class="n">clustering_coefficient</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.degrees</span> <span class="kn">import</span> <span class="n">degrees</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.export_to_orientdb</span> <span class="kn">import</span> <span class="n">export_to_orientdb</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.global_clustering_coefficient</span> <span class="kn">import</span> <span class="n">global_clustering_coefficient</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.label_propagation</span> <span class="kn">import</span> <span class="n">label_propagation</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.loopy_belief_propagation</span> <span class="kn">import</span> <span class="n">loopy_belief_propagation</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.page_rank</span> <span class="kn">import</span> <span class="n">page_rank</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.save</span> <span class="kn">import</span> <span class="n">save</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.triangle_count</span> <span class="kn">import</span> <span class="n">triangle_count</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.vertex_count</span> <span class="kn">import</span> <span class="n">vertex_count</span>
    <span class="kn">from</span> <span class="nn">sparktk.graph.ops.weighted_degrees</span> <span class="kn">import</span> <span class="n">weighted_degrees</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#sparktk.graph.graph.Graph">Graph</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="sparktk.graph.graph.Graph.graphframe" class="name">var <span class="ident">graphframe</span></p>
            

            
  
    <div class="desc"><p>The underlying graphframe object which exposes several methods and properties</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, tc, source_or_vertices_frame, edges_frame=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.__init__', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.__init__" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tc</span><span class="p">,</span> <span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">edges_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span> <span class="o">=</span> <span class="n">tc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c"># (note that the Scala code will validate appropriate frame schemas)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_or_vertices_frame</span><span class="p">,</span> <span class="n">Frame</span><span class="p">):</span>
        <span class="c"># Python Vertices and Edges Frames</span>
        <span class="n">vertices_frame</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
        <span class="n">require_type</span><span class="p">(</span><span class="n">Frame</span><span class="p">,</span>
                     <span class="n">edges_frame</span><span class="p">,</span>
                     <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                     <span class="s">&quot;Providing a vertices frame requires also providing an edges frame&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span>
                                                                 <span class="n">vertices_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">,</span>
                                                                 <span class="n">edges_frame</span><span class="o">.</span><span class="n">_scala</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">source_or_vertices_frame</span>
        <span class="n">require_type</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">edges_frame</span><span class="p">,</span>
                     <span class="s">&#39;edges_frame&#39;</span><span class="p">,</span>
                     <span class="s">&#39;If edges_frames is provided, then a valid vertex frame must be provided as the first arg, instead of type </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graph</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="c"># Scala Graph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">GraphFrame</span><span class="p">):</span>
            <span class="c"># python GraphFrame</span>
            <span class="n">scala_graphframe</span> <span class="o">=</span>  <span class="n">source</span><span class="o">.</span><span class="n">_jvm_graph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">scala_graphframe</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_scala_graphframe</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="c"># scala GraphFrame</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_scala_graph_from_scala_graphframe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Cannot create from source type </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.clustering_coefficient">
    <p>def <span class="ident">clustering_coefficient</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The clustering coefficient of a vertex provides a measure of how
tightly clustered that vertex's neighborhood is.</p>
<p>Formally:</p>
<p>.. math::</p>
<p>cc(v)  = rac{ \| { (u,v,w) \in V^3: \ {u,v}, {u, w}, {v,w } \in            E } \| }{\| { (u,v,w) \in V^3: \ {v, u }, {v, w} \in E } \|}</p>
<p>For further reading on clustering
coefficients, see http://en.wikipedia.org/wiki/Clustering_coefficient.</p>
<p>This method returns a frame with the vertex id associated with it's local
clustering coefficient</p>
<div class='section-header'>Parameters:</div>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's and their clustering coefficient</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.clustering_coefficient()
&gt;&gt;&gt; result.inspect()
[#]  id  clustering_coefficient
===============================
[0]   1          0.333333333333
[1]   2                     1.0
[2]   3                     1.0
[3]   4                     0.0
[4]   5                     0.0
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.clustering_coefficient', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.clustering_coefficient" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">clustering_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The clustering coefficient of a vertex provides a measure of how</span>
<span class="sd">    tightly clustered that vertex&#39;s neighborhood is.</span>
<span class="sd">    </span>
<span class="sd">    Formally:</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">    </span>
<span class="sd">       cc(v)  = \frac{ \| \{ (u,v,w) \in V^3: \ \{u,v\}, \{u, w\}, \{v,w \} \in \</span>
<span class="sd">           E \} \| }{\| \{ (u,v,w) \in V^3: \ \{v, u \}, \{v, w\} \in E \} \|}</span>
<span class="sd">    </span>
<span class="sd">    For further reading on clustering</span>
<span class="sd">    coefficients, see http://en.wikipedia.org/wiki/Clustering_coefficient.</span>
<span class="sd">    </span>
<span class="sd">    This method returns a frame with the vertex id associated with it&#39;s local</span>
<span class="sd">    clustering coefficient</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s and their clustering coefficient</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.clustering_coefficient()</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  id  clustering_coefficient</span>
<span class="sd">        ===============================</span>
<span class="sd">        [0]   1          0.333333333333</span>
<span class="sd">        [1]   2                     1.0</span>
<span class="sd">        [2]   3                     1.0</span>
<span class="sd">        [3]   4                     0.0</span>
<span class="sd">        [4]   5                     0.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">clusteringCoefficient</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.connected_components">
    <p>def <span class="ident">connected_components</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Connected components determines groups all the vertices in a particular graph
by whether or not there is path between these vertices. This method returns
a frame with the vertices and their corresponding component</p>
<div class='section-header'>Parameters:</div>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's and their components</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [4, 5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.connected_components()
&gt;&gt;&gt; result.inspect() 
[#]  id  component
==================
[0]   1          1
[1]   2          1
[2]   3          1
[3]   4          4
[4]   5          4
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.connected_components', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.connected_components" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">connected_components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Connected components determines groups all the vertices in a particular graph</span>
<span class="sd">    by whether or not there is path between these vertices. This method returns</span>
<span class="sd">    a frame with the vertices and their corresponding component</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s and their components</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.connected_components()</span>
<span class="sd">        &gt;&gt;&gt; result.inspect() </span>
<span class="sd">        [#]  id  component</span>
<span class="sd">        ==================</span>
<span class="sd">        [0]   1          1</span>
<span class="sd">        [1]   2          1</span>
<span class="sd">        [2]   3          1</span>
<span class="sd">        [3]   4          4</span>
<span class="sd">        [4]   5          4</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">connectedComponents</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.create_edges_frame">
    <p>def <span class="ident">create_edges_frame</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a frame representing the edges stored in this graph</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.create_edges_frame', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.create_edges_frame" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create_edges_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a frame representing the edges stored in this graph&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.create_vertices_frame">
    <p>def <span class="ident">create_vertices_frame</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates a frame representing the vertices stored in this graph</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.create_vertices_frame', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.create_vertices_frame" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">create_vertices_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a frame representing the vertices stored in this graph&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">graphFrame</span><span class="p">()</span><span class="o">.</span><span class="n">vertices</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.degrees">
    <p>def <span class="ident">degrees</span>(</p><p>self, degree_option=&#39;undirected&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p><strong>Degree Calculation</strong></p>
<p>A fundamental quantity in graph analysis is the degree of a vertex:
The degree of a vertex is the number of edges adjacent to it.</p>
<p>For a directed edge relation, a vertex has both an out-degree (the number of
edges leaving the vertex) and an in-degree (the number of edges entering the
vertex).</p>
<div class='section-header'>Parameters:</div>

<table><tr><td class='param-name'>degree_option</td><td class='param-type'>(String):</td><td class='param-desc'>Either in, out or undirected. String describing the direction of edges</td></tr></table>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's an their weights</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.degrees(degree_option=&quot;out&quot;)
&gt;&gt;&gt; result.inspect() 
[#]  id  degree
===============
[0]   1       3
[1]   2       1
[2]   3       0
[3]   4       1
[4]   5       0


&gt;&gt;&gt; result = graph.degrees(degree_option=&quot;in&quot;)
&gt;&gt;&gt; result.inspect()
[#]  id  degree
===============
[0]   1       0
[1]   2       1
[2]   3       2
[3]   4       1
[4]   5       1
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.degrees', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.degrees" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">degrees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degree_option</span><span class="o">=</span><span class="s">&#39;undirected&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Degree Calculation**</span>

<span class="sd">    A fundamental quantity in graph analysis is the degree of a vertex:</span>
<span class="sd">    The degree of a vertex is the number of edges adjacent to it.</span>

<span class="sd">    For a directed edge relation, a vertex has both an out-degree (the number of</span>
<span class="sd">    edges leaving the vertex) and an in-degree (the number of edges entering the</span>
<span class="sd">    vertex).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :param degree_option: (String) Either in, out or undirected. String describing the direction of edges</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s an their weights</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.degrees(degree_option=&quot;out&quot;)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect() </span>
<span class="sd">        [#]  id  degree</span>
<span class="sd">        ===============</span>
<span class="sd">        [0]   1       3</span>
<span class="sd">        [1]   2       1</span>
<span class="sd">        [2]   3       0</span>
<span class="sd">        [3]   4       1</span>
<span class="sd">        [4]   5       0</span>


<span class="sd">        &gt;&gt;&gt; result = graph.degrees(degree_option=&quot;in&quot;)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  id  degree</span>
<span class="sd">        ===============</span>
<span class="sd">        [0]   1       0</span>
<span class="sd">        [1]   2       1</span>
<span class="sd">        [2]   3       2</span>
<span class="sd">        [3]   4       1</span>
<span class="sd">        [4]   5       1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">degree_option</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.export_to_orientdb">
    <p>def <span class="ident">export_to_orientdb</span>(</p><p>self, db_url, user_name, password, root_password, vertex_type_column_name=None, edge_type_column_name=None, batch_size=1000)</p>
    </div>
    

    
  
    <div class="desc"><p>Export Spark-tk Graph (GraphFrame) to OrientDB API creates OrientDB database with the given database name, URL
and credentials. It exports the vertex and edge dataframes schema OrientDB based on the given vertex_type_column_name
and edge_type_column_name. If any of them was None it exports it to the base type class.</p>
<div class='section-header'>Parameters:</div>

<p>:param:(str) db_url: OrientDB URI
:param:(str) user_name: the database username
:param:(str) password: the database password
:param:(str) root_password: OrientDB server password
:param:(Optional(str)) vertex_type_column_name: column name from the vertex data frame specified to be the vertex type
:param:(Optional(str)) edge_type_column_name: column name from the edge data frame specified to be the edge type
:param:(int) batch_size: batch size for graph ETL to OrientDB database</p>
<div class='section-header'>Example:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; v = tc.frame.create([(&quot;a&quot;, &quot;Alice&quot;, 34,&quot;F&quot;),
...     (&quot;b&quot;, &quot;Bob&quot;, 36,&quot;M&quot;),
...     (&quot;c&quot;, &quot;Charlie&quot;, 30,&quot;M&quot;),
...     (&quot;d&quot;, &quot;David&quot;, 29,&quot;M&quot;),
...     (&quot;e&quot;, &quot;Esther&quot;, 32,&quot;F&quot;),
...     (&quot;f&quot;, &quot;Fanny&quot;, 36,&quot;F&quot;),
...     ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;,&quot;gender&quot;])

&gt;&gt;&gt; e = tc.frame.create([(&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),
...     (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),
...     (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),
...     (&quot;f&quot;, &quot;c&quot;, &quot;follow&quot;),
...     (&quot;e&quot;, &quot;f&quot;, &quot;follow&quot;),
...     (&quot;e&quot;, &quot;d&quot;, &quot;friend&quot;),
...     (&quot;d&quot;, &quot;a&quot;, &quot;friend&quot;),
...     (&quot;a&quot;, &quot;e&quot;, &quot;friend&quot;)
...     ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])

&gt;&gt;&gt; sparktk_graph = tc.graph.create(v,e)

&gt;&gt;&gt; db = &quot;test_db&quot;

&gt;&gt;&gt; result = sparktk_graph.export_to_orientdb(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;,vertex_type_column_name= &quot;gender&quot;,edge_type_column_name=&quot;relationship&quot;)

&gt;&gt;&gt; result
db_uri                    = remote:hostname:2424/test_db
edge_types                = {u&#39;follow&#39;: 4L, u&#39;friend&#39;: 4L}
exported_edges_summary    = {u&#39;Total Exported Edges Count&#39;: 8L, u&#39;Failure Count&#39;: 0L}
exported_vertices_summary = {u&#39;Total Exported Vertices Count&#39;: 6L, u&#39;Failure Count&#39;: 0L}
vertex_types              = {u&#39;M&#39;: 3L, u&#39;F&#39;: 3L}
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.export_to_orientdb', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.export_to_orientdb" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">export_to_orientdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db_url</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">root_password</span><span class="p">,</span><span class="n">vertex_type_column_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">edge_type_column_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export Spark-tk Graph (GraphFrame) to OrientDB API creates OrientDB database with the given database name, URL</span>
<span class="sd">    and credentials. It exports the vertex and edge dataframes schema OrientDB based on the given vertex_type_column_name</span>
<span class="sd">    and edge_type_column_name. If any of them was None it exports it to the base type class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :param:(str) db_url: OrientDB URI</span>
<span class="sd">    :param:(str) user_name: the database username</span>
<span class="sd">    :param:(str) password: the database password</span>
<span class="sd">    :param:(str) root_password: OrientDB server password</span>
<span class="sd">    :param:(Optional(str)) vertex_type_column_name: column name from the vertex data frame specified to be the vertex type</span>
<span class="sd">    :param:(Optional(str)) edge_type_column_name: column name from the edge data frame specified to be the edge type</span>
<span class="sd">    :param:(int) batch_size: batch size for graph ETL to OrientDB database</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">        &gt;&gt;&gt; v = tc.frame.create([(&quot;a&quot;, &quot;Alice&quot;, 34,&quot;F&quot;),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;Bob&quot;, 36,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;Charlie&quot;, 30,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;David&quot;, 29,&quot;M&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;Esther&quot;, 32,&quot;F&quot;),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;Fanny&quot;, 36,&quot;F&quot;),</span>
<span class="sd">        ...     ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;,&quot;gender&quot;])</span>

<span class="sd">        &gt;&gt;&gt; e = tc.frame.create([(&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;f&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;d&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;a&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;a&quot;, &quot;e&quot;, &quot;friend&quot;)</span>
<span class="sd">        ...     ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])</span>

<span class="sd">        &gt;&gt;&gt; sparktk_graph = tc.graph.create(v,e)</span>

<span class="sd">        &gt;&gt;&gt; db = &quot;test_db&quot;</span>

<span class="sd">        &gt;&gt;&gt; result = sparktk_graph.export_to_orientdb(db_url=&quot;remote:hostname:2424/%s&quot; % db,user_name= &quot;admin&quot;,password = &quot;admin&quot;,root_password = &quot;orientdb_server_root_password&quot;,vertex_type_column_name= &quot;gender&quot;,edge_type_column_name=&quot;relationship&quot;)</span>

<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        db_uri                    = remote:hostname:2424/test_db</span>
<span class="sd">        edge_types                = {u&#39;follow&#39;: 4L, u&#39;friend&#39;: 4L}</span>
<span class="sd">        exported_edges_summary    = {u&#39;Total Exported Edges Count&#39;: 8L, u&#39;Failure Count&#39;: 0L}</span>
<span class="sd">        exported_vertices_summary = {u&#39;Total Exported Vertices Count&#39;: 6L, u&#39;Failure Count&#39;: 0L}</span>
<span class="sd">        vertex_types              = {u&#39;M&#39;: 3L, u&#39;F&#39;: 3L}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExportToOrientdbReturn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">exportToOrientdb</span><span class="p">(</span><span class="n">db_url</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">root_password</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_scala_option</span><span class="p">(</span><span class="n">vertex_type_column_name</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">_jutils</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_scala_option</span><span class="p">(</span><span class="n">edge_type_column_name</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.global_clustering_coefficient">
    <p>def <span class="ident">global_clustering_coefficient</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The clustering coefficient of a graph provides a measure of how tightly
clustered an undirected graph is.</p>
<p>More formally:</p>
<p>.. math::</p>
<div class="codehilite"><pre>cc(G)  = rac{ \| \{ (u,v,w) \in V^3: \ \{u,v\}, \{u, w\}, \{v,w \} \in             E \} \| }{\| \{ (u,v,w) \in V^3: \ \{u,v\}, \{u, w\} \in E \} \|}
</pre></div>


<div class='section-header'>Parameters:</div>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Double): </td><td class='param-desc'>The global clustering coefficient of the graph</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>The clustering coefficient on a graph with some triangles will be
greater than 0

&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)

&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; graph.global_clustering_coefficient()
0.5

The clustering coefficient on a graph with no triangles (a tree) is
0

&gt;&gt;&gt; vertex_rows_star = [ [1], [2], [3], [4]]
&gt;&gt;&gt; vertex_frame_star = tc.frame.create(vertex_rows_star, vertex_schema)

&gt;&gt;&gt; edge_rows_star = [ [1, 2], [1, 3], [1, 4]]
&gt;&gt;&gt; edge_frame_star = tc.frame.create(edge_rows_star, edge_schema)

&gt;&gt;&gt; graph_star = tc.graph.create(vertex_frame_star, edge_frame_star)

&gt;&gt;&gt; graph_star.global_clustering_coefficient()
0.0
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.global_clustering_coefficient', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.global_clustering_coefficient" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">global_clustering_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    The clustering coefficient of a graph provides a measure of how tightly</span>
<span class="sd">    clustered an undirected graph is.</span>

<span class="sd">    More formally:</span>

<span class="sd">    .. math::</span>

<span class="sd">        cc(G)  = \frac{ \| \{ (u,v,w) \in V^3: \ \{u,v\}, \{u, w\}, \{v,w \} \in \</span>
<span class="sd">            E \} \| }{\| \{ (u,v,w) \in V^3: \ \{u,v\}, \{u, w\} \in E \} \|}</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :return: (Double) The global clustering coefficient of the graph</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">        </span>
<span class="sd">        The clustering coefficient on a graph with some triangles will be</span>
<span class="sd">        greater than 0</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>

<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; graph.global_clustering_coefficient()</span>
<span class="sd">        0.5</span>

<span class="sd">        The clustering coefficient on a graph with no triangles (a tree) is</span>
<span class="sd">        0</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows_star = [ [1], [2], [3], [4]]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame_star = tc.frame.create(vertex_rows_star, vertex_schema)</span>

<span class="sd">        &gt;&gt;&gt; edge_rows_star = [ [1, 2], [1, 3], [1, 4]]</span>
<span class="sd">        &gt;&gt;&gt; edge_frame_star = tc.frame.create(edge_rows_star, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph_star = tc.graph.create(vertex_frame_star, edge_frame_star)</span>

<span class="sd">        &gt;&gt;&gt; graph_star.global_clustering_coefficient()</span>
<span class="sd">        0.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">globalClusteringCoefficient</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.label_propagation">
    <p>def <span class="ident">label_propagation</span>(</p><p>self, max_iterations)</p>
    </div>
    

    
  
    <div class="desc"><div class='section-header'>Parameters:</div>

<p>Assigns label based off of proximity to different vertices. The labels
are initially 1 unique label per vertex (the vertex id), and as the
algorithm runs some of these get erased</p>
<p>Note this algorithm is neither guaranteed to converge, nor guaranteed to
converge to the correct value.</p>
<p>This calls graph frames label propagation which can be found at </p>
<p>http://graphframes.github.io/api/scala/index.html#org.graphframes.lib.LabelPropagation</p>
<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's and the community they are a member of</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]

&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.label_propagation(10)
&gt;&gt;&gt; result.inspect()
[#]  id  label
==============
[0]   1      1
[1]   2      2
[2]   3      2
[3]   4      2
[4]   5      1
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.label_propagation', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.label_propagation" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">label_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    Assigns label based off of proximity to different vertices. The labels</span>
<span class="sd">    are initially 1 unique label per vertex (the vertex id), and as the</span>
<span class="sd">    algorithm runs some of these get erased</span>

<span class="sd">    Note this algorithm is neither guaranteed to converge, nor guaranteed to</span>
<span class="sd">    converge to the correct value.</span>

<span class="sd">    This calls graph frames label propagation which can be found at </span>

<span class="sd">    http://graphframes.github.io/api/scala/index.html#org.graphframes.lib.LabelPropagation</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s and the community they are a member of</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>

<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.label_propagation(10)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  id  label</span>
<span class="sd">        ==============</span>
<span class="sd">        [0]   1      1</span>
<span class="sd">        [1]   2      2</span>
<span class="sd">        [2]   3      2</span>
<span class="sd">        [3]   4      2</span>
<span class="sd">        [4]   5      1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">labelPropagation</span><span class="p">(</span><span class="n">max_iterations</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.loopy_belief_propagation">
    <p>def <span class="ident">loopy_belief_propagation</span>(</p><p>self, prior, edge_weight, max_iterations=10)</p>
    </div>
    

    
  
    <div class="desc"><p>Performs loopy belief propagation on a graph representing a Potts model. This optimizes based off of
user provided priors.</p>
<div class='section-header'>Parameters:</div>

<table><tr><td class='param-name'>prior</td><td class='param-type'>(String):</td><td class='param-desc'>The name of the column of space delimited string of floats representing the prior distribution on a vertex
</td></tr></table>

<table><tr><td class='param-name'>edge_weight</td><td class='param-type'>(String):</td><td class='param-desc'>The name of the column of weight value on edges
</td></tr></table>

<table><tr><td class='param-name'>max_iterations: </td><td class='param-desc'>The number of iterations to run for</td></tr></table>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int), (&#39;label&#39;, float), (&quot;prior_val&quot;, str), (&quot;was_labeled&quot;, int)]
&gt;&gt;&gt; vertex_rows = [ [1, 1, &quot;0.7 0.3&quot;, 1], [2, 1, &quot;0.7 0.3&quot;, 1], [3, 5, &quot;0.7 0.3&quot;, 0], [4, 5, &quot;0.7 0.3&quot;, 0], [5, 5, &quot;0.7 0.3&quot;, 1] ]

&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int), (&#39;weight&#39;, int)]
&gt;&gt;&gt; edge_rows = [ [1, 2, 2], [1, 3, 1], [2, 3, 1], [1, 4, 1], [4, 5, 1] ]

&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)
&gt;&gt;&gt; vertex_frame.inspect()
[#]  id  label  prior_val  was_labeled
======================================
[0]   1    1.0  0.7 0.3              1
[1]   2    1.0  0.7 0.3              1
[2]   3    5.0  0.7 0.3              0
[3]   4    5.0  0.7 0.3              0
[4]   5    5.0  0.7 0.3              1

&gt;&gt;&gt; result = graph.loopy_belief_propagation(&quot;prior_val&quot;, &quot;weight&quot;, 2)
&gt;&gt;&gt; result.inspect() 
[#]  id  label  prior_val  was_labeled
======================================
[0]   1    1.0  0.7 0.3              1
[1]   2    1.0  0.7 0.3              1
[2]   3    5.0  0.7 0.3              0
[3]   4    5.0  0.7 0.3              0
[4]   5    5.0  0.7 0.3              1
&lt;BLANKLINE&gt;
[#]  posterior
==============================================
[0]  [0.9883347610773112,0.011665238922688819]
[1]  [0.9743014865548763,0.025698513445123698]
[2]  [0.9396772870897875,0.06032271291021254]
[3]  [0.9319529856190276,0.06804701438097235]
[4]  [0.8506957305238876,0.1493042694761125]
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.loopy_belief_propagation', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.loopy_belief_propagation" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">loopy_belief_propagation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">edge_weight</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Performs loopy belief propagation on a graph representing a Potts model. This optimizes based off of</span>
<span class="sd">    user provided priors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :param prior: (String) The name of the column of space delimited string of floats representing the prior distribution on a vertex</span>
<span class="sd">    :param edge_weight: (String) The name of the column of weight value on edges</span>
<span class="sd">    :param max_iterations: The number of iterations to run for</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int), (&#39;label&#39;, float), (&quot;prior_val&quot;, str), (&quot;was_labeled&quot;, int)]</span>
<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1, 1, &quot;0.7 0.3&quot;, 1], [2, 1, &quot;0.7 0.3&quot;, 1], [3, 5, &quot;0.7 0.3&quot;, 0], [4, 5, &quot;0.7 0.3&quot;, 0], [5, 5, &quot;0.7 0.3&quot;, 1] ]</span>

<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int), (&#39;weight&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2, 2], [1, 3, 1], [2, 3, 1], [1, 4, 1], [4, 5, 1] ]</span>

<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame.inspect()</span>
<span class="sd">        [#]  id  label  prior_val  was_labeled</span>
<span class="sd">        ======================================</span>
<span class="sd">        [0]   1    1.0  0.7 0.3              1</span>
<span class="sd">        [1]   2    1.0  0.7 0.3              1</span>
<span class="sd">        [2]   3    5.0  0.7 0.3              0</span>
<span class="sd">        [3]   4    5.0  0.7 0.3              0</span>
<span class="sd">        [4]   5    5.0  0.7 0.3              1</span>

<span class="sd">        &gt;&gt;&gt; result = graph.loopy_belief_propagation(&quot;prior_val&quot;, &quot;weight&quot;, 2)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect() </span>
<span class="sd">        [#]  id  label  prior_val  was_labeled</span>
<span class="sd">        ======================================</span>
<span class="sd">        [0]   1    1.0  0.7 0.3              1</span>
<span class="sd">        [1]   2    1.0  0.7 0.3              1</span>
<span class="sd">        [2]   3    5.0  0.7 0.3              0</span>
<span class="sd">        [3]   4    5.0  0.7 0.3              0</span>
<span class="sd">        [4]   5    5.0  0.7 0.3              1</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        [#]  posterior</span>
<span class="sd">        ==============================================</span>
<span class="sd">        [0]  [0.9883347610773112,0.011665238922688819]</span>
<span class="sd">        [1]  [0.9743014865548763,0.025698513445123698]</span>
<span class="sd">        [2]  [0.9396772870897875,0.06032271291021254]</span>
<span class="sd">        [3]  [0.9319529856190276,0.06804701438097235]</span>
<span class="sd">        [4]  [0.8506957305238876,0.1493042694761125]</span>



<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">loopyBeliefPropagation</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">edge_weight</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.page_rank">
    <p>def <span class="ident">page_rank</span>(</p><p>self, convergence_tolerance=None, reset_probability=None, max_iterations=None)</p>
    </div>
    

    
  
    <div class="desc"><p><strong>Page Rank</strong></p>
<p>Page Rank is a popular statistic that ranks vertices based off of
connectivity in the global graph</p>
<p>Exactly 1 of convergence_tolerance and max_iterations must be set (termination criteria)</p>
<div class='section-header'>Parameters:</div>

<p>:convergence_tolerance: (Float) If the difference between successive iterations is less than this, the algorithm terminates. Mutually exclusive with max_iterations
:reset_probability: (Float) Value for the reset probabiity in the page rank algorithm
:max_iterations: (Int) Maximum number of iterations the page rank should run before terminating. Mutually exclusive with convergence_tolerance</p>
<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's and their page rank </td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.page_rank(max_iterations=20)
&gt;&gt;&gt; result.inspect()
[#]  id  pagerank
=================
[0]   1      0.15
[1]   2    0.1925
[2]   3  0.356125
[3]   4    0.1925
[4]   5  0.313625
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.page_rank', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.page_rank" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">page_rank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convergence_tolerance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">reset_probability</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Page Rank**</span>

<span class="sd">    Page Rank is a popular statistic that ranks vertices based off of</span>
<span class="sd">    connectivity in the global graph</span>

<span class="sd">    Exactly 1 of convergence_tolerance and max_iterations must be set (termination criteria)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :convergence_tolerance: (Float) If the difference between successive iterations is less than this, the algorithm terminates. Mutually exclusive with max_iterations</span>
<span class="sd">    :reset_probability: (Float) Value for the reset probabiity in the page rank algorithm</span>
<span class="sd">    :max_iterations: (Int) Maximum number of iterations the page rank should run before terminating. Mutually exclusive with convergence_tolerance</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s and their page rank </span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.page_rank(max_iterations=20)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  id  pagerank</span>
<span class="sd">        =================</span>
<span class="sd">        [0]   1      0.15</span>
<span class="sd">        [1]   2    0.1925</span>
<span class="sd">        [2]   3  0.356125</span>
<span class="sd">        [3]   4    0.1925</span>
<span class="sd">        [4]   5  0.313625</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">pageRank</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">jutils</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_scala_option</span><span class="p">(</span><span class="n">max_iterations</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">jutils</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_scala_option</span><span class="p">(</span><span class="n">reset_probability</span><span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">jutils</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to_scala_option</span><span class="p">(</span><span class="n">convergence_tolerance</span><span class="p">)))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.save">
    <p>def <span class="ident">save</span>(</p><p>self, path)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.save', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.save" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.triangle_count">
    <p>def <span class="ident">triangle_count</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Counts the number of triangles each vertex is a part of</p>
<div class='section-header'>Parameters:</div>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's and the count of the number of triangle they are in</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.triangle_count()
&gt;&gt;&gt; result.inspect()
[#]  count  id 
==============
[0]      1   1
[1]      1   2
[2]      1   3
[3]      0   4
[4]      0   5
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.triangle_count', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.triangle_count" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">triangle_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts the number of triangles each vertex is a part of</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s and the count of the number of triangle they are in</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1], [2], [3], [4], [5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2], [1, 3], [2, 3], [1, 4], [4, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.triangle_count()</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  count  id </span>
<span class="sd">        ==============</span>
<span class="sd">        [0]      1   1</span>
<span class="sd">        [1]      1   2</span>
<span class="sd">        [2]      1   3</span>
<span class="sd">        [3]      0   4</span>
<span class="sd">        [4]      0   5</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">triangleCount</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.vertex_count">
    <p>def <span class="ident">vertex_count</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the number of rows in the vertices frame in this graph</p>
<div class='section-header'>Example:</div>

<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">graphframes</span> <span class="kn">import</span> <span class="n">examples</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">gf</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">Graphs</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">sql_context</span><span class="p">)</span><span class="o">.</span><span class="n">friends</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">sparktk.graph.graph</span> <span class="kn">import</span> <span class="n">Graph</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">gf</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex_count</span><span class="p">()</span>
<span class="mi">6</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">create</span><span class="p">([(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;Charlie&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;David&quot;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;Esther&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="s">&quot;Fanny&quot;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">],</span> <span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;age&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">create</span><span class="p">([(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;friend&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;follow&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="s">&quot;follow&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;follow&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="s">&quot;follow&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;friend&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;friend&quot;</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;friend&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="p">],</span> <span class="p">[</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;dst&quot;</span><span class="p">,</span> <span class="s">&quot;relationship&quot;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">g2</span><span class="o">.</span><span class="n">vertex_count</span><span class="p">()</span>
<span class="mi">6</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.vertex_count', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.vertex_count" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">vertex_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of rows in the vertices frame in this graph</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">        &gt;&gt;&gt; from graphframes import examples</span>

<span class="sd">        &gt;&gt;&gt; gf = examples.Graphs(tc.sql_context).friends()</span>

<span class="sd">        &gt;&gt;&gt; from sparktk.graph.graph import Graph</span>

<span class="sd">        &gt;&gt;&gt; g = Graph(tc, gf)</span>

<span class="sd">        &gt;&gt;&gt; g.vertex_count()</span>
<span class="sd">        6</span>


<span class="sd">        &gt;&gt;&gt; v = tc.frame.create([(&quot;a&quot;, &quot;Alice&quot;, 34),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;Bob&quot;, 36),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;Charlie&quot;, 30),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;David&quot;, 29),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;Esther&quot;, 32),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;Fanny&quot;, 36),</span>
<span class="sd">        ...     ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;])</span>

<span class="sd">        &gt;&gt;&gt; e = tc.frame.create([(&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;f&quot;, &quot;c&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;f&quot;, &quot;follow&quot;),</span>
<span class="sd">        ...     (&quot;e&quot;, &quot;d&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;d&quot;, &quot;a&quot;, &quot;friend&quot;),</span>
<span class="sd">        ...     (&quot;a&quot;, &quot;e&quot;, &quot;friend&quot;)</span>
<span class="sd">        ...     ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])</span>

<span class="sd">        &gt;&gt;&gt; g2 = tc.graph.create(v, e)</span>

<span class="sd">        &gt;&gt;&gt; g2.vertex_count()</span>
<span class="sd">        6</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">vertexCount</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="sparktk.graph.graph.Graph.weighted_degrees">
    <p>def <span class="ident">weighted_degrees</span>(</p><p>self, edge_weight, degree_option=&#39;undirected&#39;, default_weight=0.0)</p>
    </div>
    

    
  
    <div class="desc"><p><strong>Degree Calculation</strong></p>
<p>A fundamental quantity in graph analysis is the degree of a vertex:
The degree of a vertex is the number of edges adjacent to it.</p>
<p>For a directed edge relation, a vertex has both an out-degree (the number of
edges leaving the vertex) and an in-degree (the number of edges entering the
vertex).</p>
<p>In the presence of edge weights, vertices can have weighted degrees: The
weighted degree of a vertex is the sum of weights of edges adjacent to it.
Analogously, the weighted in-degree of a vertex is the sum of the weights of
the edges entering it, and the weighted out-degree is the sum
of the weights of the edges leaving the vertex. If a property is missing or
empty on particular vertex, the default weight is used.</p>
<div class='section-header'>Parameters:</div>

<table><tr><td class='param-name'>edge_weight</td><td class='param-type'>(String):</td><td class='param-desc'>Name of the property that contains and edge weight
</td></tr></table>

<table><tr><td class='param-name'>degree_option</td><td class='param-type'>(String):</td><td class='param-desc'>Either in, out or undirected. String describing the direction of edges
</td></tr></table>

<table><tr><td class='param-name'>default_weight</td><td class='param-type'>(Numeric):</td><td class='param-desc'>Default weight value if a vertex has no value for the edge weight property</td></tr></table>

<p><table style='padding-top:10px'><tr><td class='param-name'>Returns</td><td class='param-type'>(Frame): </td><td class='param-desc'>Frame containing the vertex id's an their weights</td></tr></table></p>

<div class='section-header'>Examples:</div>

<div class="codehilite"><pre>&gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int), (&#39;label&#39;, float)]
&gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int), (&#39;weight&#39;, int)]

&gt;&gt;&gt; vertex_rows = [ [1, 1], [2, 1], [3, 5], [4, 5], [5, 5] ]
&gt;&gt;&gt; edge_rows = [ [1, 2, 2], [1, 3, 1], [2, 3, 1], [1, 4, 1], [4, 5, 1] ]
&gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)
&gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)

&gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)

&gt;&gt;&gt; result = graph.weighted_degrees(edge_weight=&quot;weight&quot;, degree_option=&quot;out&quot;)
&gt;&gt;&gt; result.inspect() 
[#]  id  degree
===============
[0]   1       4
[1]   2       1
[2]   3       0
[3]   4       1
[4]   5       0


&gt;&gt;&gt; result = graph.weighted_degrees(edge_weight=&quot;weight&quot;, degree_option=&quot;in&quot;)
&gt;&gt;&gt; result.inspect()
[#]  id  degree
===============
[0]   1       0
[1]   2       2
[2]   3       2
[3]   4       1
[4]   5       1
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-sparktk.graph.graph.Graph.weighted_degrees', this);">Show source &equiv;</a></p>
  <div id="source-sparktk.graph.graph.Graph.weighted_degrees" class="source">
    <div class="codehilite"><pre><span class="k">def</span> <span class="nf">weighted_degrees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_weight</span><span class="p">,</span> <span class="n">degree_option</span><span class="o">=</span><span class="s">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">default_weight</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Degree Calculation**</span>

<span class="sd">    A fundamental quantity in graph analysis is the degree of a vertex:</span>
<span class="sd">    The degree of a vertex is the number of edges adjacent to it.</span>

<span class="sd">    For a directed edge relation, a vertex has both an out-degree (the number of</span>
<span class="sd">    edges leaving the vertex) and an in-degree (the number of edges entering the</span>
<span class="sd">    vertex).</span>

<span class="sd">    In the presence of edge weights, vertices can have weighted degrees: The</span>
<span class="sd">    weighted degree of a vertex is the sum of weights of edges adjacent to it.</span>
<span class="sd">    Analogously, the weighted in-degree of a vertex is the sum of the weights of</span>
<span class="sd">    the edges entering it, and the weighted out-degree is the sum</span>
<span class="sd">    of the weights of the edges leaving the vertex. If a property is missing or</span>
<span class="sd">    empty on particular vertex, the default weight is used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    :param edge_weight: (String) Name of the property that contains and edge weight</span>
<span class="sd">    :param degree_option: (String) Either in, out or undirected. String describing the direction of edges</span>
<span class="sd">    :param default_weight: (Numeric) Default weight value if a vertex has no value for the edge weight property</span>

<span class="sd">    :return: (Frame) Frame containing the vertex id&#39;s an their weights</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; vertex_schema = [(&#39;id&#39;, int), (&#39;label&#39;, float)]</span>
<span class="sd">        &gt;&gt;&gt; edge_schema = [(&#39;src&#39;, int), (&#39;dst&#39;, int), (&#39;weight&#39;, int)]</span>

<span class="sd">        &gt;&gt;&gt; vertex_rows = [ [1, 1], [2, 1], [3, 5], [4, 5], [5, 5] ]</span>
<span class="sd">        &gt;&gt;&gt; edge_rows = [ [1, 2, 2], [1, 3, 1], [2, 3, 1], [1, 4, 1], [4, 5, 1] ]</span>
<span class="sd">        &gt;&gt;&gt; vertex_frame = tc.frame.create(vertex_rows, vertex_schema)</span>
<span class="sd">        &gt;&gt;&gt; edge_frame = tc.frame.create(edge_rows, edge_schema)</span>

<span class="sd">        &gt;&gt;&gt; graph = tc.graph.create(vertex_frame, edge_frame)</span>

<span class="sd">        &gt;&gt;&gt; result = graph.weighted_degrees(edge_weight=&quot;weight&quot;, degree_option=&quot;out&quot;)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect() </span>
<span class="sd">        [#]  id  degree</span>
<span class="sd">        ===============</span>
<span class="sd">        [0]   1       4</span>
<span class="sd">        [1]   2       1</span>
<span class="sd">        [2]   3       0</span>
<span class="sd">        [3]   4       1</span>
<span class="sd">        [4]   5       0</span>


<span class="sd">        &gt;&gt;&gt; result = graph.weighted_degrees(edge_weight=&quot;weight&quot;, degree_option=&quot;in&quot;)</span>
<span class="sd">        &gt;&gt;&gt; result.inspect()</span>
<span class="sd">        [#]  id  degree</span>
<span class="sd">        ===============</span>
<span class="sd">        [0]   1       0</span>
<span class="sd">        [1]   2       2</span>
<span class="sd">        [2]   3       2</span>
<span class="sd">        [3]   4       1</span>
<span class="sd">        [4]   5       1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sparktk.frame.frame</span> <span class="kn">import</span> <span class="n">Frame</span>
    <span class="k">return</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scala</span><span class="o">.</span><span class="n">weightedDegree</span><span class="p">(</span><span class="n">edge_weight</span><span class="p">,</span> <span class="n">degree_option</span><span class="p">,</span> <span class="n">default_weight</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

        </div>
        <div class="clear" />
        <footer id="footer">
          <div>
            spark-tk Python API Documentation
          </div>
        </footer>
      </article>
  </div>
</body>
</html>
